<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">

    
    <title>Heap Overflow in Floating Point Parsing (CVE-2013-4164)</title>
    

    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta itemprop="image" content="https://www.ruby-lang.org/images/header-ruby-logo@2x.png">
    
    <meta name="description" content="">
    

    <link rel="stylesheet" type="text/css" href="/stylesheets/normalize.css">
    <link rel="stylesheet" type="text/css" href="/stylesheets/main.css">
    <link rel="stylesheet" type="text/css" href="/stylesheets/pygments.css">
    <link rel="stylesheet" type="text/css" href="/stylesheets/mobile.css">
    <link rel="stylesheet" type="text/css" href="/stylesheets/print.css">
    <link href='https://fonts.googleapis.com/css?family=Noto+Sans:400,700,400italic,700italic&amp;subset=latin,cyrillic,greek,vietnamese' rel='stylesheet' type='text/css'>
    <link rel="canonical" href="https://www.ruby-lang.org/en/news/2013/11/22/heap-overflow-in-floating-point-parsing-cve-2013-4164/">

    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico">
    
    <link href="/en/feeds/news.rss" rel="alternate" title="Recent News (RSS)" type="application/rss+xml">


    <script type="text/javascript" src="/javascripts/jquery.min.js"></script>
    <script type="text/javascript" src="/javascripts/page.js"></script>
    
  </head>

  

  <body>
    <div id="header">
      <div id="header_content" class="container">
        <a href="/en/">
          <h1>Ruby</h1>
          <h2>A Programmer's Best Friend</h2>
        </a>

        <div class="site-links">
          

  <a href="/en/" class="home">Home</a>

  <a href="/en/downloads/">Downloads</a>

  <a href="/en/documentation/">Documentation</a>

  <a href="/en/libraries/">Libraries</a>

  <a href="/en/community/">Community</a>

  <a href="/en/news/">News</a>

  <a href="/en/security/">Security</a>

  <a href="/en/about/">About Ruby</a>


          <a href="#" class="menu selected">Menu</a>
        </div>

        <div id="search-box">
          
<form id="search-form" action="https://www.google.com/cse">
  <table class="fieldset">
    <tr>
      <td>
        <input class="field" type="text" name="q" size="31" style="background: white url(//www.google.com/coop/intl/en/images/google_custom_search_watermark.gif) left no-repeat" onfocus="this.style.background='white'" onblur="if (/^\s*$/.test(this.value)) this.style.background='white url(//www.google.com/coop/intl/en/images/google_custom_search_watermark.gif) left no-repeat'"/>
      </td>
      <td>
        <input type="hidden" name="cx" value="013598269713424429640:g5orptiw95w" />
        <input type="hidden" name="ie" value="UTF-8" />
        <input class="button" type="submit" name="sa" value="Search" />
      </td>
    </tr>
  </table>
</form>

        </div>
      </div>
    </div>

    <div id="page">
      


      <div id="main-wrapper" class="container">
        <div id="main">
          

<div id="content-wrapper">
  
<h1>Heap Overflow in Floating Point Parsing (CVE-2013-4164)</h1>



  <div id="content">
    <p class="post-info">Posted by tenderlove on 22 Nov 2013</p>

    <p>There is an overflow in floating point number parsing in Ruby. This
vulnerability has been assigned the CVE identifier CVE-2013-4164.</p>
<h2>Details</h2>
<p>Any time a string is converted to a floating point value, a specially crafted
string can cause a heap overflow.  This can lead to a denial of service attack
via segmentation faults and possibly arbitrary code execution.  Any program
that converts input of unknown origin to floating point values (especially
common when accepting JSON) are vulnerable.</p>
<p>Vulnerable code looks something like this:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>untrusted_data.to_f
</code></pre></div></div>
<p>But any code that produces floating point values from external data is
vulnerable, such as this:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>JSON.parse untrusted_data
</code></pre></div></div>
<p>Note that this bug is similar to CVE-2009-0689.</p>
<p>All users running an affected release should upgrade to the FIXED versions
of Ruby.</p>
<h2>Affected versions</h2>
<ul>
<li>All Ruby 1.8 versions after Ruby 1.8.6 patchlevel 230</li>
<li>All Ruby 1.9 versions prior to Ruby 1.9.3 patchlevel 484</li>
<li>All Ruby 2.0 versions prior to Ruby 2.0.0 patchlevel 353</li>
<li>All Ruby 2.1 versions prior to Ruby 2.1.0 preview2</li>
<li>prior to trunk revision 43780</li>
</ul>
<h2>Solutions</h2>
<p>All users are recommended to upgrade to Ruby 1.9.3 patchlevel 484,
Ruby 2.0.0 patchlevel 353 or Ruby 2.1.0 preview2.</p>
<p>Please note that Ruby 1.8 series or any earlier releases are already
obsoleted.  There is no plan to release new FIXED versions for them.
Users of such versions are advised to upgrade as soon as possible as
we cannot guarantee the continued availability of security fixes for
unsupported releases.</p>
<h2>Credits</h2>
<p>Thanks to Charlie Somerville for reporting this issue!</p>
<h2>History</h2>
<ul>
<li>Originally published at 2013-11-22 04:00:00 UTC</li>
<li>Secondary published at 2013-11-22 06:46:00 UTC</li>
<li>Thirdly published at 2013-11-22 22:46:00 UTC</li>
<li>Fourthly published at 2013-12-10 12:09:38 UTC</li>
</ul>

  </div>
</div>
<hr class="hidden-modern" />

<div id="sidebar-wrapper">
  <div id="sidebar">
    <div class="navigation">
      

      <h3><strong>Recent News</strong></h3>

      <ul class="menu">
        
        <li><a href="/en/news/2022/12/25/ruby-3-2-0-released/">Ruby 3.2.0 Released</a></li>
        
        <li><a href="/en/news/2022/12/06/ruby-3-2-0-rc1-released/">Ruby 3.2.0 RC 1 Released</a></li>
        
        <li><a href="/en/news/2022/11/24/ruby-3-1-3-released/">Ruby 3.1.3 Released</a></li>
        
        <li><a href="/en/news/2022/11/24/ruby-3-0-5-released/">Ruby 3.0.5 Released</a></li>
        
        <li><a href="/en/news/2022/11/24/ruby-2-7-7-released/">Ruby 2.7.7 Released</a></li>
        
      </ul>
    </div>

    

    <h3>Syndicate</h3>
    <p><a href="/en/feeds/news.rss">Recent News (RSS)</a></p>
  </div>
</div>
<hr class="hidden-modern" />

        </div>
      </div>
    </div>

    <div class="container">
      <div id="footer">
        <div class="site-links">
          

  <a href="/en/" class="home">Home</a>

  <a href="/en/downloads/">Downloads</a>

  <a href="/en/documentation/">Documentation</a>

  <a href="/en/libraries/">Libraries</a>

  <a href="/en/community/">Community</a>

  <a href="/en/news/">News</a>

  <a href="/en/security/">Security</a>

  <a href="/en/about/">About Ruby</a>


        </div>

        <p>

  This site in other languages:

<a href="/bg/">Български</a>,
<a href="/de/">Deutsch</a>,
<a href="/en/">English</a>,
<a href="/es/">Español</a>,
<a href="/fr/">Français</a>,
<a href="/id/">Bahasa Indonesia</a>,
<a href="/it/">Italiano</a>,
<a href="/ja/">日本語</a>,
<a href="/ko/">한국어</a>,
<a href="/pl/">polski</a>,
<a href="/pt/">Português</a>,
<a href="/ru/">Русский</a>,
<a href="/tr/">Türkçe</a>,
<a href="/vi/">Tiếng Việt</a>,
<a href="/zh_cn/">简体中文</a>,
<a href="/zh_tw/">繁體中文</a>.
</p>

        
  <p><a href="/en/about/website/">This website</a> is proudly maintained by members of the Ruby community.</p>


      </div>
    </div>
  </body>
</html>
