<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">

    
    <title>XSS exploit of RDoc documentation generated by rdoc (CVE-2013-0256)</title>
    

    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta itemprop="image" content="https://www.ruby-lang.org/images/header-ruby-logo@2x.png">
    
    <meta name="description" content="">
    

    <link rel="stylesheet" type="text/css" href="/stylesheets/normalize.css">
    <link rel="stylesheet" type="text/css" href="/stylesheets/main.css">
    <link rel="stylesheet" type="text/css" href="/stylesheets/pygments.css">
    <link rel="stylesheet" type="text/css" href="/stylesheets/mobile.css">
    <link rel="stylesheet" type="text/css" href="/stylesheets/print.css">
    <link href='https://fonts.googleapis.com/css?family=Noto+Sans:400,700,400italic,700italic&amp;subset=latin,cyrillic,greek,vietnamese' rel='stylesheet' type='text/css'>
    <link rel="canonical" href="https://www.ruby-lang.org/en/news/2013/02/06/rdoc-xss-cve-2013-0256/">

    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico">
    
    <link href="/en/feeds/news.rss" rel="alternate" title="Recent News (RSS)" type="application/rss+xml">


    <script type="text/javascript" src="/javascripts/jquery.min.js"></script>
    <script type="text/javascript" src="/javascripts/page.js"></script>
    
  </head>

  

  <body>
    <div id="header">
      <div id="header_content" class="container">
        <a href="/en/">
          <h1>Ruby</h1>
          <h2>A Programmer's Best Friend</h2>
        </a>

        <div class="site-links">
          

  <a href="/en/" class="home">Home</a>

  <a href="/en/downloads/">Downloads</a>

  <a href="/en/documentation/">Documentation</a>

  <a href="/en/libraries/">Libraries</a>

  <a href="/en/community/">Community</a>

  <a href="/en/news/">News</a>

  <a href="/en/security/">Security</a>

  <a href="/en/about/">About Ruby</a>


          <a href="#" class="menu selected">Menu</a>
        </div>

        <div id="search-box">
          
<form id="search-form" action="https://www.google.com/cse">
  <table class="fieldset">
    <tr>
      <td>
        <input class="field" type="text" name="q" size="31" style="background: white url(//www.google.com/coop/intl/en/images/google_custom_search_watermark.gif) left no-repeat" onfocus="this.style.background='white'" onblur="if (/^\s*$/.test(this.value)) this.style.background='white url(//www.google.com/coop/intl/en/images/google_custom_search_watermark.gif) left no-repeat'"/>
      </td>
      <td>
        <input type="hidden" name="cx" value="013598269713424429640:g5orptiw95w" />
        <input type="hidden" name="ie" value="UTF-8" />
        <input class="button" type="submit" name="sa" value="Search" />
      </td>
    </tr>
  </table>
</form>

        </div>
      </div>
    </div>

    <div id="page">
      


      <div id="main-wrapper" class="container">
        <div id="main">
          

<div id="content-wrapper">
  
<h1>XSS exploit of RDoc documentation generated by rdoc (CVE-2013-0256)</h1>



  <div id="content">
    <p class="post-info">Posted by usa on 6 Feb 2013</p>

    <p>RDoc documentation generated by rdoc bundled with ruby are vulnerable to
an XSS exploit. All ruby users are recommended to update ruby to newer
version which includes security-fixed RDoc. If you are publishing RDoc
documentation generated by rdoc, you are recommended to apply a patch
for the documentation or re-generate it with security-fixed RDoc.</p>
<h2>Impact</h2>
<p>RDoc documentation generated by rdoc 2.3.0 through rdoc 3.12 and
prereleases up to rdoc 4.0.0.preview2.1 are vulnerable to an XSS
exploit. This exploit may lead to cookie disclosure to third parties.</p>
<h2>Details</h2>
<p>The exploit exists in darkfish.js which is copied from the RDoc install
location to the generated documentation.</p>
<p>RDoc is a static documentation generation tool. Patching the library
itself is insufficient to correct this exploit. Those hosting rdoc
documentation will need to apply the following patch.</p>
<h2>Solution</h2>
<p>Please apply the following patch to rdoc documentation. If applied while
ignoring whitespace, this patch will correct all affected versions:</p>
<!-- raw HTML omitted -->
<ul>
<li>$(&quot;a[name=&quot; + anchor + &quot;]&quot;).each( function() {
<!-- raw HTML omitted -->-    if ( !$(this).parent().parent().hasClass('target-section') ) {</li>
<li>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> console.debug( "Wrapping the target-section" );
</code></pre></div></div>
</li>
<li>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> $('div.method-detail').unwrap( 'div.target-section' );
</code></pre></div></div>
</li>
<li>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> $(this).parent().wrap( '&amp;lt;div class="target-section"&amp;gt;&amp;lt;/div&amp;gt;' );
</code></pre></div></div>
</li>
<li>} else {</li>
<li>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> console.debug( "Already wrapped." );
</code></pre></div></div>
</li>
</ul>
<p><!-- raw HTML omitted --><!-- raw HTML omitted -->+  $(&quot;a[name]&quot;).each( function() {</p>
<ul>
<li>if ( $(this).attr(&quot;name&quot;) == anchor ) {</li>
<li>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> if ( !$(this).parent().parent().hasClass('target-section') ) {
</code></pre></div></div>
</li>
<li>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   console.debug( "Wrapping the target-section" );
</code></pre></div></div>
</li>
<li>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   $('div.method-detail').unwrap( 'div.target-section' );
</code></pre></div></div>
</li>
<li>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   $(this).parent().wrap( '&amp;lt;div class="target-section"&amp;gt;&amp;lt;/div&amp;gt;' );
</code></pre></div></div>
</li>
<li>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> } else {
</code></pre></div></div>
</li>
<li>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   console.debug( "Already wrapped." );
</code></pre></div></div>
</li>
<li>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> }
</code></pre></div></div>
</li>
</ul>
<p><!-- raw HTML omitted -->     }
});
};<!-- raw HTML omitted --><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<p>And, if you are using ruby 1.9, please update <a href="https://www.ruby-lang.org/en/news/2013/02/06/ruby-1-9-3-p385-is-released/">ruby-1.9.3 patchlevel
385</a>. If you are using ruby 2.0.0 rc1 or prior or ruby trunk, please
update to ruby 2.0.0 rc2 or trunk revision 39102 or later. You can also
update RDoc itself with rubygems to RDoc 3.12.1 or RDoc 4.0.0.rc.2.</p>
<h2>Affected versions</h2>
<ul>
<li>All ruby 1.9 versions prior to ruby 1.9.3 patchlevel 383</li>
<li>All ruby 2.0 versions prior to ruby 2.0.0 rc2 or prior to trunk
revision 39102</li>
</ul>
<h2>Credit</h2>
<p>This exploit was discovered by Evgeny Ermakov &lt;corwmh@gmail.com&gt;.</p>
<p>This vulnerability has been assigned the CVE identifier CVE-2013-0256.</p>
<h2>History</h2>
<ul>
<li>Originally published at 2013-02-06 13:30:00 (UTC)</li>
</ul>

  </div>
</div>
<hr class="hidden-modern" />

<div id="sidebar-wrapper">
  <div id="sidebar">
    <div class="navigation">
      

      <h3><strong>Recent News</strong></h3>

      <ul class="menu">
        
        <li><a href="/en/news/2022/12/25/ruby-3-2-0-released/">Ruby 3.2.0 Released</a></li>
        
        <li><a href="/en/news/2022/12/06/ruby-3-2-0-rc1-released/">Ruby 3.2.0 RC 1 Released</a></li>
        
        <li><a href="/en/news/2022/11/24/ruby-3-1-3-released/">Ruby 3.1.3 Released</a></li>
        
        <li><a href="/en/news/2022/11/24/ruby-3-0-5-released/">Ruby 3.0.5 Released</a></li>
        
        <li><a href="/en/news/2022/11/24/ruby-2-7-7-released/">Ruby 2.7.7 Released</a></li>
        
      </ul>
    </div>

    

    <h3>Syndicate</h3>
    <p><a href="/en/feeds/news.rss">Recent News (RSS)</a></p>
  </div>
</div>
<hr class="hidden-modern" />

        </div>
      </div>
    </div>

    <div class="container">
      <div id="footer">
        <div class="site-links">
          

  <a href="/en/" class="home">Home</a>

  <a href="/en/downloads/">Downloads</a>

  <a href="/en/documentation/">Documentation</a>

  <a href="/en/libraries/">Libraries</a>

  <a href="/en/community/">Community</a>

  <a href="/en/news/">News</a>

  <a href="/en/security/">Security</a>

  <a href="/en/about/">About Ruby</a>


        </div>

        <p>

  This site in other languages:

<a href="/bg/">Български</a>,
<a href="/de/">Deutsch</a>,
<a href="/en/">English</a>,
<a href="/es/">Español</a>,
<a href="/fr/">Français</a>,
<a href="/id/">Bahasa Indonesia</a>,
<a href="/it/">Italiano</a>,
<a href="/ja/">日本語</a>,
<a href="/ko/">한국어</a>,
<a href="/pl/">polski</a>,
<a href="/pt/">Português</a>,
<a href="/ru/">Русский</a>,
<a href="/tr/">Türkçe</a>,
<a href="/vi/">Tiếng Việt</a>,
<a href="/zh_cn/">简体中文</a>,
<a href="/zh_tw/">繁體中文</a>.
</p>

        
  <p><a href="/en/about/website/">This website</a> is proudly maintained by members of the Ruby community.</p>


      </div>
    </div>
  </body>
</html>
