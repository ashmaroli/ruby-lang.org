<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">

    
    <title>Hash-flooding DoS vulnerability for ruby 1.9 (CVE-2012-5371)</title>
    

    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta itemprop="image" content="https://www.ruby-lang.org/images/header-ruby-logo@2x.png">
    
    <meta name="description" content="">
    

    <link rel="stylesheet" type="text/css" href="/stylesheets/normalize.css">
    <link rel="stylesheet" type="text/css" href="/stylesheets/main.css">
    <link rel="stylesheet" type="text/css" href="/stylesheets/pygments.css">
    <link rel="stylesheet" type="text/css" href="/stylesheets/mobile.css">
    <link rel="stylesheet" type="text/css" href="/stylesheets/print.css">
    <link href='https://fonts.googleapis.com/css?family=Noto+Sans:400,700,400italic,700italic&amp;subset=latin,cyrillic,greek,vietnamese' rel='stylesheet' type='text/css'>
    <link rel="canonical" href="https://www.ruby-lang.org/en/news/2012/11/09/ruby19-hashdos-cve-2012-5371/">

    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico">
    
    <link href="/en/feeds/news.rss" rel="alternate" title="Recent News (RSS)" type="application/rss+xml">


    <script type="text/javascript" src="/javascripts/jquery.min.js"></script>
    <script type="text/javascript" src="/javascripts/page.js"></script>
    
  </head>

  

  <body>
    <div id="header">
      <div id="header_content" class="container">
        <a href="/en/">
          <h1>Ruby</h1>
          <h2>A Programmer's Best Friend</h2>
        </a>

        <div class="site-links">
          

  <a href="/en/" class="home">Home</a>

  <a href="/en/downloads/">Downloads</a>

  <a href="/en/documentation/">Documentation</a>

  <a href="/en/libraries/">Libraries</a>

  <a href="/en/community/">Community</a>

  <a href="/en/news/">News</a>

  <a href="/en/security/">Security</a>

  <a href="/en/about/">About Ruby</a>


          <a href="#" class="menu selected">Menu</a>
        </div>

        <div id="search-box">
          
<form id="search-form" action="https://www.google.com/cse">
  <table class="fieldset">
    <tr>
      <td>
        <input class="field" type="text" name="q" size="31" style="background: white url(//www.google.com/coop/intl/en/images/google_custom_search_watermark.gif) left no-repeat" onfocus="this.style.background='white'" onblur="if (/^\s*$/.test(this.value)) this.style.background='white url(//www.google.com/coop/intl/en/images/google_custom_search_watermark.gif) left no-repeat'"/>
      </td>
      <td>
        <input type="hidden" name="cx" value="013598269713424429640:g5orptiw95w" />
        <input type="hidden" name="ie" value="UTF-8" />
        <input class="button" type="submit" name="sa" value="Search" />
      </td>
    </tr>
  </table>
</form>

        </div>
      </div>
    </div>

    <div id="page">
      


      <div id="main-wrapper" class="container">
        <div id="main">
          

<div id="content-wrapper">
  
<h1>Hash-flooding DoS vulnerability for ruby 1.9 (CVE-2012-5371)</h1>



  <div id="content">
    <p class="post-info">Posted by usa on 9 Nov 2012</p>

    <p>Hash-flooding DoS attack reported for the Hash function ruby 1.9 series
were using. This vulnerability is different from <a href="https://www.ruby-lang.org/en/news/2011/12/28/denial-of-service-attack-was-found-for-rubys-hash-algorithm-cve-2011-4815/">CVE-2011-4815</a> for
ruby 1.8.7. All ruby 1.9 users are recommended to upgrade to <a href="https://www.ruby-lang.org/en/news/2012/11/09/ruby-1-9-3-p327-is-released/">ruby-1.9.3
patchlevel 327</a> to get this security fix.</p>
<h2>Impact</h2>
<p>Carefully crafted sequence of strings can cause a denial of service
attack on the service that parses the sequence to create a Hash object
by using the strings as keys. For instance, this vulnerability affects
web application that parses the JSON data sent from untrusted entity.</p>
<h2>Details</h2>
<p>This vulnerability is similar to <a href="https://www.ruby-lang.org/en/news/2011/12/28/denial-of-service-attack-was-found-for-rubys-hash-algorithm-cve-2011-4815/">CVE-2011-4815</a> for ruby 1.8.7. ruby
1.9 versions were using modified <a href="https://sites.google.com/site/murmurhash/">MurmurHash function</a> but it's
<a href="http://2012.appsec-forum.ch/conferences/#c17">reported that there is a way to create sequence of strings that collide
their hash values each other</a>. This fix changes the Hash function of
String object from the MurmurHash to <a href="https://www.131002.net/siphash/">SipHash 2-4</a>.</p>
<h2>Solution</h2>
<p>Please update to <a href="https://www.ruby-lang.org/en/news/2012/11/09/ruby-1-9-3-p327-is-released/">ruby-1.9.3 patchlevel 327</a> if you are using ruby
1.9 versions. Please update to trunk revision 37575 or later if you are
using ruby 2.0.0 preview1 or ruby trunk. In addition to it, all ruby
applications that accept input data from untrusted entity for parsing
should restrict the size of the input data to reasonable size. We are
not sure if we can provide protection against this kind of vulnerability
at programming language level in the future.</p>
<h2>Affected versions</h2>
<ul>
<li>All ruby 1.9 versions prior to ruby 1.9.3 patchlevel 327</li>
<li>All ruby 2.0 versions (includes 2.0.0 preview1) prior to trunk
revision 37575</li>
</ul>
<h2>Credit</h2>
<p>This vulnerability is reported by Jean-Philippe Aumasson, one of the
designer of SipHash. The original SipHash implementation for this fix is
presented by Martin Boßlet, one of the ruby committer.</p>
<h2>Updates</h2>
<ul>
<li>A typo fixed at 2012-11-21 22:16:00</li>
<li>Originally published at 2012-11-10 04:23:00</li>
</ul>

  </div>
</div>
<hr class="hidden-modern" />

<div id="sidebar-wrapper">
  <div id="sidebar">
    <div class="navigation">
      

      <h3><strong>Recent News</strong></h3>

      <ul class="menu">
        
        <li><a href="/en/news/2022/12/25/ruby-3-2-0-released/">Ruby 3.2.0 Released</a></li>
        
        <li><a href="/en/news/2022/12/06/ruby-3-2-0-rc1-released/">Ruby 3.2.0 RC 1 Released</a></li>
        
        <li><a href="/en/news/2022/11/24/ruby-3-1-3-released/">Ruby 3.1.3 Released</a></li>
        
        <li><a href="/en/news/2022/11/24/ruby-3-0-5-released/">Ruby 3.0.5 Released</a></li>
        
        <li><a href="/en/news/2022/11/24/ruby-2-7-7-released/">Ruby 2.7.7 Released</a></li>
        
      </ul>
    </div>

    

    <h3>Syndicate</h3>
    <p><a href="/en/feeds/news.rss">Recent News (RSS)</a></p>
  </div>
</div>
<hr class="hidden-modern" />

        </div>
      </div>
    </div>

    <div class="container">
      <div id="footer">
        <div class="site-links">
          

  <a href="/en/" class="home">Home</a>

  <a href="/en/downloads/">Downloads</a>

  <a href="/en/documentation/">Documentation</a>

  <a href="/en/libraries/">Libraries</a>

  <a href="/en/community/">Community</a>

  <a href="/en/news/">News</a>

  <a href="/en/security/">Security</a>

  <a href="/en/about/">About Ruby</a>


        </div>

        <p>

  This site in other languages:

<a href="/bg/">Български</a>,
<a href="/de/">Deutsch</a>,
<a href="/en/">English</a>,
<a href="/es/">Español</a>,
<a href="/fr/">Français</a>,
<a href="/id/">Bahasa Indonesia</a>,
<a href="/it/">Italiano</a>,
<a href="/ja/">日本語</a>,
<a href="/ko/">한국어</a>,
<a href="/pl/">polski</a>,
<a href="/pt/">Português</a>,
<a href="/ru/">Русский</a>,
<a href="/tr/">Türkçe</a>,
<a href="/vi/">Tiếng Việt</a>,
<a href="/zh_cn/">简体中文</a>,
<a href="/zh_tw/">繁體中文</a>.
</p>

        
  <p><a href="/en/about/website/">This website</a> is proudly maintained by members of the Ruby community.</p>


      </div>
    </div>
  </body>
</html>
