<?xml version="1.0" encoding="UTF-8"?>


<rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>Ruby 新闻更新</title>
    <link>https://www.ruby-lang.org/zh_cn/feeds/news.rss</link>
    <language>zh-CN</language>
    <ttl>40</ttl>
    <description>来自 ruby-lang.org 的最新文章。</description>
    
    <item>
      <title>Ruby 3.2.0 已发布</title>
      <description>&lt;p&gt;我们很高兴地宣布 Ruby 3.2.0。Ruby 3.2 增加了很多新功能和性能改进。&lt;/p&gt;
&lt;h2&gt;基于 WASI 的 WebAssembly 支持&lt;/h2&gt;
&lt;p&gt;这是首次基于 WASI 的 WebAssembly 支持。使得 CRuby 二进制内容可用于浏览器、Serverless Edge、以及其他 WebAssembly/WASI 嵌入环境。目前，此功能已通过除 Thread API 之外的 basic 和 bootstrap 测试套件。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://i.imgur.com/opCgKy2.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
&lt;h3&gt;背景&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;https://webassembly.org/&quot;&gt;WebAssembly (Wasm)&lt;/a&gt; 希望能够在浏览器中提供安全快速的运行程序的方式。但其目标，也就是在不同环境中安全高效的运行程序，不仅是 web 应用长期以来的目标，也是其他一般程序所需要的。&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://wasi.dev/&quot;&gt;WASI (The WebAssembly System Interface)&lt;/a&gt; 被设计用于此类应用场景。尽管此类应用需要与操作系统进行通信，WebAssembly 却运行在一个没有系统接口的虚拟机之上。WASI 使之标准化。&lt;/p&gt;
&lt;p&gt;基于这些项目，Ruby 的 WebAssembly/WASI 支持能使 Ruby 开发者可以编写能运行于兼容此类功能的平台上。&lt;/p&gt;
&lt;h3&gt;应用场景&lt;/h3&gt;
&lt;p&gt;此功能使得开发人员可以在 WebAssembly 环境中使用 CRuby。一个此类应用场景的案例是 &lt;a href=&quot;https://try.ruby-lang.org/playground/&quot;&gt;TryRuby playground&lt;/a&gt; 的 CRuby 支持。现在您可以在您的浏览器中尝试原生的 CRuby。&lt;/p&gt;
&lt;h3&gt;技术要点&lt;/h3&gt;
&lt;p&gt;目前，WASI 和 WebAssembly 仍在不断演进，同时基于安全原因，还缺少一些功能来实现纤程、异常和垃圾回收。
所以，CRuby 使用了一种可以控制用户空间中执行的二进制转换技术 Asyncify 来填补这一鸿沟。&lt;/p&gt;
&lt;p&gt;此外，我们创建了 &lt;a href=&quot;https://github.com/kateinoigakukun/wasi-vfs/wiki/Getting-Started-with-CRuby&quot;&gt;WASI 之上的虚拟文件系统&lt;/a&gt;，于是就可以很容易地将 Ruby 应用打包成单个 .wasm 文件，进而简化分发 Ruby 应用的过程。&lt;/p&gt;
&lt;h3&gt;相关链接&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/ruby/ruby/pull/5407&quot;&gt;Add WASI based WebAssembly support #5407&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://itnext.io/final-report-webassembly-wasi-support-in-ruby-4aface7d90c9&quot;&gt;An Update on WebAssembly/WASI Support in Ruby&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Production-ready YJIT&lt;/h2&gt;
&lt;p&gt;&lt;img src=&quot;https://i.imgur.com/X9ulfac.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;YJIT is no longer experimental
&lt;ul&gt;
&lt;li&gt;Has been tested on production workloads for over a year and proven to be quite stable.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;YJIT now supports both x86-64 and arm64/aarch64 CPUs on Linux, MacOS, BSD and other UNIX platforms.
&lt;ul&gt;
&lt;li&gt;This release brings support for Apple M1/M2, AWS Graviton, Raspberry Pi 4 and more.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Building YJIT now requires Rust 1.58.0+. [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/18481&quot;&gt;Feature #18481&lt;/a&gt;]
&lt;ul&gt;
&lt;li&gt;In order to ensure that CRuby is built with YJIT, please install &lt;code&gt;rustc&lt;/code&gt; &amp;gt;= 1.58.0
before running the &lt;code&gt;./configure&lt;/code&gt; script.&lt;/li&gt;
&lt;li&gt;Please reach out to the YJIT team should you run into any issues.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;The YJIT 3.2 release is faster than 3.1, and has about 1/3 as much memory overhead.
&lt;ul&gt;
&lt;li&gt;Overall YJIT is 41% faster (geometric mean) than the Ruby interpreter on &lt;a href=&quot;https://github.com/Shopify/yjit-bench&quot;&gt;yjit-bench&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;Physical memory for JIT code is lazily allocated. Unlike Ruby 3.1,
the RSS of a Ruby process is minimized because virtual memory pages
allocated by &lt;code&gt;--yjit-exec-mem-size&lt;/code&gt; will not be mapped to physical
memory pages until actually utilized by JIT code.&lt;/li&gt;
&lt;li&gt;Introduce Code GC that frees all code pages when the memory consumption
by JIT code reaches &lt;code&gt;--yjit-exec-mem-size&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;RubyVM::YJIT.runtime_stats&lt;/code&gt; returns Code GC metrics in addition to
existing &lt;code&gt;inline_code_size&lt;/code&gt; and &lt;code&gt;outlined_code_size&lt;/code&gt; keys:
&lt;code&gt;code_gc_count&lt;/code&gt;, &lt;code&gt;live_page_count&lt;/code&gt;, &lt;code&gt;freed_page_count&lt;/code&gt;, and &lt;code&gt;freed_code_size&lt;/code&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Most of the statistics produced by &lt;code&gt;RubyVM::YJIT.runtime_stats&lt;/code&gt; are now available in release builds.
&lt;ul&gt;
&lt;li&gt;Simply run ruby with &lt;code&gt;--yjit-stats&lt;/code&gt; to compute and dump stats (incurs some run-time overhead).&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;YJIT is now optimized to take advantage of object shapes. [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/18776&quot;&gt;Feature #18776&lt;/a&gt;]&lt;/li&gt;
&lt;li&gt;Take advantage of finer-grained constant invalidation to invalidate less code when defining new constants. [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/18589&quot;&gt;Feature #18589&lt;/a&gt;]&lt;/li&gt;
&lt;li&gt;The default &lt;code&gt;--yjit-exec-mem-size&lt;/code&gt; is changed to 64 (MiB).&lt;/li&gt;
&lt;li&gt;The default &lt;code&gt;--yjit-call-threshold&lt;/code&gt; is changed to 30.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Regexp 用于防御 ReDoS 攻击的改进&lt;/h2&gt;
&lt;p&gt;众所周知，正则表达式匹配的耗时可能出乎意料的长。如果您的代码尝试从一个不可信输入中匹配一个低效的正则表达式，攻击者可以借此发起有效的拒绝服务攻击(所谓的正则表达式 DoS，或 ReDoS)。&lt;/p&gt;
&lt;p&gt;我们引入了2个更新，能够显著减轻 ReDoS 的影响&lt;/p&gt;
&lt;h3&gt;改进 Regexp 匹配算法&lt;/h3&gt;
&lt;p&gt;自 Ruby 3.2 开始，Regexp 的匹配算法通过缓存技术得到了显著改进。
新增正则表达式匹配的超时设置。&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# 下面的正则匹配在 Ruby 3.1 中耗时10秒，在 Ruby 3.2 中耗时0.003秒

/^a*b?a*$/ =~ &quot;a&quot; * 50000 + &quot;x&quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;https://cache.ruby-lang.org/pub/media/ruby320_regex_1.png&quot; alt=&quot;&quot; /&gt;
&lt;img src=&quot;https://cache.ruby-lang.org/pub/media/ruby320_regex_2.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
&lt;p&gt;通过改进的匹配算法，使得 Regexp 的匹配（根据我们的实验，约90%）能够在线性时间内完成。&lt;/p&gt;
&lt;p&gt;此改进可能会消耗与每个匹配的输入长度成比例的内存。我们预计不会出现实际问题，因为这种内存分配通常会延迟，并且正常的 Regexp 匹配最多只会消耗表达式长度10倍的内存。如果您在实际应用中遇到 Regexp 匹配导致的内存不足情况，请报告给我们。&lt;/p&gt;
&lt;p&gt;最初提议 &lt;a href=&quot;https://bugs.ruby-lang.org/issues/19104&quot;&gt;https://bugs.ruby-lang.org/issues/19104&lt;/a&gt;&lt;/p&gt;
&lt;h3&gt;Regexp 超时设置&lt;/h3&gt;
&lt;p&gt;上面的改进不能使用于某些正则表达式，比如使用了某些高级特性（例如：反向引用 back-references，环视 look-around），或者大量使用固定重复次数。作为一种后备措施，Regexp 还引入了超时设置功能。&lt;/p&gt;
&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;no&quot;&gt;Regexp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;timeout&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.0&lt;/span&gt;

&lt;span class=&quot;sr&quot;&gt;/^a*b?a*()\1$/&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=~&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;a&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;50000&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;x&quot;&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#=&amp;gt; 1秒后 Regexp::TimeoutError&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;请注意，&lt;code&gt;Regexp.timeout&lt;/code&gt; 是全局性的配置。如果您希望对于某些特殊的正则表达式使用不同的超时设置，您可以使用 &lt;code&gt;Regexp.new&lt;/code&gt; 中的 &lt;code&gt;timeout&lt;/code&gt; 关键词。&lt;/p&gt;
&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;no&quot;&gt;Regexp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;timeout&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.0&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# 这个 Regexp 没有超时设置&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;long_time_re&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Regexp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;^a*b?a*()&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\1&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;$&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;timeout: &lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Float&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;INFINITY&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;long_time_re&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=~&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;a&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;50000&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;x&quot;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# 不会被中断&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;最初提议：&lt;a href=&quot;https://bugs.ruby-lang.org/issues/17837&quot;&gt;https://bugs.ruby-lang.org/issues/17837&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;其他值得注意的新功能&lt;/h2&gt;
&lt;h3&gt;语法建议&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;syntax_suggest&lt;/code&gt;（曾用名 &lt;code&gt;dead_end&lt;/code&gt;）的功能已被集成到 Ruby。这可以帮助您找到错误的位置，例如缺失或多余的 &lt;code&gt;end&lt;/code&gt;，让您更快地修正错误，例如下面的例子：&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Unmatched `end', missing keyword (`do', `def`, `if`, etc.) ?

  1  class Dog
&amp;gt; 2    defbark
&amp;gt; 3    end
  4  end
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;[&lt;a href=&quot;https://bugs.ruby-lang.org/issues/18159&quot;&gt;Feature #18159&lt;/a&gt;]&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;错误提示&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;现在，在 TypeError 和 ArgumentError 中将指出出错的参数&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;test.rb:2:in `+': nil can't be coerced into Integer (TypeError)

sum = ary[0] + ary[1]
               ^^^^^^
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;h3&gt;语言&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;除了在方法参数中使用，匿名的可变长参数现在可以作为参数进行传递
[&lt;a href=&quot;https://bugs.ruby-lang.org/issues/18351&quot;&gt;Feature #18351&lt;/a&gt;]&lt;/p&gt;
&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;foo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;bar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;baz&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;quux&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;接受一个单独位置参数的 proc 不再会自动解封装。 [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/18633&quot;&gt;Bug #18633&lt;/a&gt;]&lt;/p&gt;
&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;nb&quot;&gt;proc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;call&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Ruby 3.1 及之前版本&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# =&amp;gt; 1&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Ruby 3.2 及之后版本&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# =&amp;gt; [1, 2]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;对于显示对象的常量赋值求值顺序，将始终使用单属性赋值求值顺序。参考下面的代码:&lt;/p&gt;
&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;n&quot;&gt;foo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;BAR&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;baz&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;code&gt;foo&lt;/code&gt; 现在在 &lt;code&gt;baz&lt;/code&gt; 之前求值。类似的，对于多重常量的赋值，使用从左到右的求值顺序。参考下面的代码:&lt;/p&gt;
&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code data-lang=&quot;ruby&quot;&gt;  &lt;span class=&quot;n&quot;&gt;foo1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;BAR1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;foo2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;BAR2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;baz1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;baz2&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;现在使用下面的求值顺序:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code&gt;foo1&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;foo2&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;baz1&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;baz2&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;[&lt;a href=&quot;https://bugs.ruby-lang.org/issues/15928&quot;&gt;Bug #15928&lt;/a&gt;]&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;查找模式不再是实验性功能。
[&lt;a href=&quot;https://bugs.ruby-lang.org/issues/18585&quot;&gt;Feature #18585&lt;/a&gt;]&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;使用可变长参数 (例如 &lt;code&gt;*args&lt;/code&gt;) 的方法，如果同时希望通过 &lt;code&gt;foo(*args)&lt;/code&gt; 使用关键词参数的，那么必须使用 &lt;code&gt;ruby2_keywords&lt;/code&gt; 进行标记。也就是说，所有希望通过 &lt;code&gt;*args&lt;/code&gt; 来使用关键字参数的方法现在毫无例外地都必须使用
&lt;code&gt;ruby2_keywords&lt;/code&gt; 进行标记。一旦某个库需要 Ruby 3+，这将是一个更容易的过渡升级方式。此前，当接收方法使用 &lt;code&gt;*args&lt;/code&gt; 时，&lt;code&gt;ruby2_keywords&lt;/code&gt; 标记被保留，但这可能是错误并且是行为不一致的。对于查找潜在缺失的
&lt;code&gt;ruby2_keywords&lt;/code&gt; 的好方法应当是运行测试套件，检查测试失败时调用的最后一个方法，这个方法必须接收关键词参数。通过在错误处使用 &lt;code&gt;puts nil, caller, nil&lt;/code&gt;，然后检查在调用链上的每一个使用自动委派关键词的方法/块被标记为
&lt;code&gt;ruby2_keywords&lt;/code&gt;。 [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/18625&quot;&gt;Bug #18625&lt;/a&gt;] [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/16466&quot;&gt;Bug #16466&lt;/a&gt;]&lt;/p&gt;
&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;target&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;kw&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Ruby 2.7-3.1 可以意外地在没有 ruby2_keywords 的情况下执行，在 3.2 中必需。&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# 如需去除 ruby2_keywords，需要修改 #foo 和 #bar 的参数为 (*args, **kwargs) 或 (...)。&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ruby2_keywords&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;bar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;target&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;ruby2_keywords&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;foo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;bar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;foo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;k: &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;性能改进&lt;/h2&gt;
&lt;h3&gt;MJIT&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;MJIT 编译器在 Ruby 中以 &lt;code&gt;ruby_vm/mjit/compiler&lt;/code&gt; 标准库重新实现。&lt;/li&gt;
&lt;li&gt;MJIT 编译器在分叉的(forked) Ruby 进程中执行，不再以 MJIT worker 的本地线程中执行。[&lt;a href=&quot;https://bugs.ruby-lang.org/issues/18968&quot;&gt;Feature #18968&lt;/a&gt;]
&lt;ul&gt;
&lt;li&gt;由此，不再支持 Microsoft Visual Studio (MSWIN)。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;不再支持 MinGW。[&lt;a href=&quot;https://bugs.ruby-lang.org/issues/18824&quot;&gt;Feature #18824&lt;/a&gt;]&lt;/li&gt;
&lt;li&gt;&lt;code&gt;--mjit-min-calls&lt;/code&gt; 更名为 &lt;code&gt;--mjit-call-threshold&lt;/code&gt;。&lt;/li&gt;
&lt;li&gt;将 &lt;code&gt;--mjit-max-cache&lt;/code&gt; 的默认值从 10000 修改回 100。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;PubGrub&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Bundler 2.4 现在使用 &lt;a href=&quot;https://github.com/jhawthorn/pub_grub&quot;&gt;PubGrub&lt;/a&gt; 来替换 &lt;a href=&quot;https://github.com/CocoaPods/Molinillo&quot;&gt;Molinillo&lt;/a&gt; 进行依赖解析。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;PubGrub 是 Dart 语言的 &lt;code&gt;pub&lt;/code&gt; 包管理器使用的新一代解析算法。&lt;/li&gt;
&lt;li&gt;在此次变更后，您可能会得到不同的解析结果。请将此类问题报告到 &lt;a href=&quot;https://github.com/rubygems/rubygems/issues&quot;&gt;RubyGems/Bundler 问题&lt;/a&gt;。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;RubyGems 在 Ruby 3.2 中依旧使用 Molinillo。我们计划在将来用 PubGrub 进行替换。&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;自 3.1 以来其他值得注意的变更&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Hash&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;当 hash 为空时，&lt;code&gt;Hash#shift&lt;/code&gt; 现在总是返回 nil，此前行为是返回默认值或调用默认 proc。 [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/16908&quot;&gt;Bug #16908&lt;/a&gt;]&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;MatchData&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;新增 &lt;code&gt;MatchData#byteoffset&lt;/code&gt; 。 [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/13110&quot;&gt;Feature #13110&lt;/a&gt;]&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Module&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;新增 &lt;code&gt;Module.used_refinements&lt;/code&gt; 。 [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/14332&quot;&gt;Feature #14332&lt;/a&gt;]&lt;/li&gt;
&lt;li&gt;新增 &lt;code&gt;Module#refinements&lt;/code&gt; 。 [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/12737&quot;&gt;Feature #12737&lt;/a&gt;]&lt;/li&gt;
&lt;li&gt;新增 &lt;code&gt;Module#const_added&lt;/code&gt; 。 [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/17881&quot;&gt;Feature #17881&lt;/a&gt;]&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Proc&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;Proc#dup&lt;/code&gt; 返回子类的一个实例。 [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/17545&quot;&gt;Bug #17545&lt;/a&gt;]&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Proc#parameters&lt;/code&gt; 现在接受 lambda 关键字。 [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/15357&quot;&gt;Feature #15357&lt;/a&gt;]&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Refinement&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;新增 &lt;code&gt;Refinement#refined_class&lt;/code&gt;。 [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/12737&quot;&gt;Feature #12737&lt;/a&gt;]&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;RubyVM::AbstractSyntaxTree&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;为&lt;code&gt;parse&lt;/code&gt;, &lt;code&gt;parse_file&lt;/code&gt; 和 &lt;code&gt;of&lt;/code&gt; 增加 &lt;code&gt;error_tolerant&lt;/code&gt; 选项。 [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/19013&quot;&gt;Feature #19013&lt;/a&gt;]
启用此选项时&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;不提示 SyntaxError&lt;/li&gt;
&lt;li&gt;对于错误输入，返回 AST&lt;/li&gt;
&lt;li&gt;如果当解析器处理到输入尾部而 &lt;code&gt;end&lt;/code&gt; 不足时，&lt;code&gt;end&lt;/code&gt; 将被补足&lt;/li&gt;
&lt;li&gt;&lt;code&gt;end&lt;/code&gt; 将根据缩进来进行处理&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;c1&quot;&gt;# 不启用 error_tolerant 选项时&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;root&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;RubyVM&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;AbstractSyntaxTree&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;parse&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;~&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;RUBY&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;sh&quot;&gt;
def m
  a = 10
  if
end
&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;RUBY&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# =&amp;gt; &amp;lt;internal:ast&amp;gt;:33:in `parse': syntax error, unexpected `end' (SyntaxError)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# 启用 error_tolerant 选项时&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;root&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;RubyVM&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;AbstractSyntaxTree&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;parse&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;~&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;RUBY&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;error_tolerant: &lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;sh&quot;&gt;
def m
  a = 10
  if
end
&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;RUBY&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;p&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;root&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# =&amp;gt; #&amp;lt;RubyVM::AbstractSyntaxTree::Node:SCOPE@1:0-4:3&amp;gt;&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# `end` 根据缩进来进行处理&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;root&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;RubyVM&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;AbstractSyntaxTree&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;parse&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;~&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;RUBY&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;error_tolerant: &lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;sh&quot;&gt;
module Z
  class Foo
    foo.
  end

  def bar
  end
end
&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;RUBY&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;p&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;root&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;children&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;children&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;children&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;children&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;..-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# =&amp;gt; [#&amp;lt;RubyVM::AbstractSyntaxTree::Node:CLASS@2:2-4:5&amp;gt;, #&amp;lt;RubyVM::AbstractSyntaxTree::Node:DEFN@6:2-7:5&amp;gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;为 &lt;code&gt;parse&lt;/code&gt;, &lt;code&gt;parse_file&lt;/code&gt; 和 &lt;code&gt;of&lt;/code&gt; 增加 &lt;code&gt;keep_tokens&lt;/code&gt; 选项。 [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/19070&quot;&gt;Feature #19070&lt;/a&gt;]&lt;/p&gt;
&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;n&quot;&gt;root&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;RubyVM&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;AbstractSyntaxTree&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;parse&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;x = 1 + 2&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;keep_tokens: &lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;root&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;tokens&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# =&amp;gt; [[0, :tIDENTIFIER, &quot;x&quot;, [1, 0, 1, 1]], [1, :tSP, &quot; &quot;, [1, 1, 1, 2]], ...]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;root&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;tokens&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]}.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;join&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# =&amp;gt; &quot;x = 1 + 2&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Set&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Set 现在可以直接使用，不需要调用 &lt;code&gt;require &amp;quot;set&amp;quot;&lt;/code&gt;。 [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/16989&quot;&gt;Feature #16989&lt;/a&gt;]
目前其通过 &lt;code&gt;Set&lt;/code&gt; 常量或对 &lt;code&gt;Enumerable#to_set&lt;/code&gt; 调用自动载入。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;String&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;新增 &lt;code&gt;String#byteindex&lt;/code&gt; 和 &lt;code&gt;String#byterindex&lt;/code&gt;。 [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/13110&quot;&gt;Feature #13110&lt;/a&gt;]&lt;/li&gt;
&lt;li&gt;更新 Unicode 至 Version 15.0.0，Emoji Version 15.0. [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/18639&quot;&gt;Feature #18639&lt;/a&gt;] (同样适用于 Regexp)&lt;/li&gt;
&lt;li&gt;新增 &lt;code&gt;String#bytesplice&lt;/code&gt;。  [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/18598&quot;&gt;Feature #18598&lt;/a&gt;]&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Struct&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;即使在 &lt;code&gt;Struct.new&lt;/code&gt; 中不设置 &lt;code&gt;keyword_init: true&lt;/code&gt;，Struct 类也可以通过关键词参数进行初始化。 [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/16806&quot;&gt;Feature #16806&lt;/a&gt;]&lt;/p&gt;
&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;no&quot;&gt;Post&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Struct&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;no&quot;&gt;Post&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;hello&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;#=&amp;gt; #&amp;lt;struct Post id=1, name=&quot;hello&quot;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# 自 Ruby 3.2 起，即使不设置 keyword_init: true 下面代码也可执行。&lt;/span&gt;
&lt;span class=&quot;no&quot;&gt;Post&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;id: &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;name: &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;hello&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;#=&amp;gt; #&amp;lt;struct Post id=1, name=&quot;hello&quot;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;兼容性问题&lt;/h2&gt;
&lt;p&gt;注意：不包含特性的问题修正&lt;/p&gt;
&lt;h3&gt;被移除的常量&lt;/h3&gt;
&lt;p&gt;下列废弃常量被移除。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;Fixnum&lt;/code&gt; 与 &lt;code&gt;Bignum&lt;/code&gt; [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/12005&quot;&gt;Feature #12005&lt;/a&gt;]&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Random::DEFAULT&lt;/code&gt; [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/17351&quot;&gt;Feature #17351&lt;/a&gt;]&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Struct::Group&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Struct::Passwd&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;被移除的方法&lt;/h3&gt;
&lt;p&gt;下列废弃方法被移除。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;Dir.exists?&lt;/code&gt; [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/17391&quot;&gt;Feature #17391&lt;/a&gt;]&lt;/li&gt;
&lt;li&gt;&lt;code&gt;File.exists?&lt;/code&gt; [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/17391&quot;&gt;Feature #17391&lt;/a&gt;]&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Kernel#=~&lt;/code&gt; [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/15231&quot;&gt;Feature #15231&lt;/a&gt;]&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Kernel#taint&lt;/code&gt;, &lt;code&gt;Kernel#untaint&lt;/code&gt;, &lt;code&gt;Kernel#tainted?&lt;/code&gt;
[&lt;a href=&quot;https://bugs.ruby-lang.org/issues/16131&quot;&gt;Feature #16131&lt;/a&gt;]&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Kernel#trust&lt;/code&gt;, &lt;code&gt;Kernel#untrust&lt;/code&gt;, &lt;code&gt;Kernel#untrusted?&lt;/code&gt;
[&lt;a href=&quot;https://bugs.ruby-lang.org/issues/16131&quot;&gt;Feature #16131&lt;/a&gt;]&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;标准库兼容性问题&lt;/h2&gt;
&lt;h3&gt;不再捆绑第三方源代码&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;我们不再捆绑第三方源代码，例如 &lt;code&gt;libyaml&lt;/code&gt;， &lt;code&gt;libffi&lt;/code&gt;。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;psych 中已经移除了 libyaml 的代码。您可能需要在 Ubuntu/Debian 平台中安装 &lt;code&gt;libyaml-dev&lt;/code&gt;。软件包的名称可能因平台不同而各异。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;从 &lt;code&gt;fiddle&lt;/code&gt; 中移除捆绑的 libffi 源码&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Psych 和 fiddle 支持指定 libyaml 和 libffi 的版本来静态编译。您可以像这样基于 libyaml-0.2.5 编译 psych：&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;./configure &lt;span class=&quot;nt&quot;&gt;--with-libyaml-source-dir&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/path/to/libyaml-0.2.5
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;同样，您可以像这样基于 libffi-3.4.4 编译 fiddle：&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;./configure &lt;span class=&quot;nt&quot;&gt;--with-libffi-source-dir&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/path/to/libffi-3.4.4
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;[&lt;a href=&quot;https://bugs.ruby-lang.org/issues/18571&quot;&gt;Feature #18571&lt;/a&gt;]&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;C API 更新&lt;/h2&gt;
&lt;h3&gt;更新的 C API&lt;/h3&gt;
&lt;p&gt;下列 API 被更新。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;PRNG 更新
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;rb_random_interface_t&lt;/code&gt; 被更新并设定版本。
如果扩展库使用旧版本的接口需要更新。
同样，&lt;code&gt;init_int32&lt;/code&gt; 函数需要被定义。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;被移除的 C API&lt;/h3&gt;
&lt;p&gt;下列废弃的 API 被移除。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;变量 &lt;code&gt;rb_cData&lt;/code&gt;。&lt;/li&gt;
&lt;li&gt;&amp;quot;taintedness&amp;quot; 与 &amp;quot;trustedness&amp;quot; 函数。 [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/16131&quot;&gt;Feature #16131&lt;/a&gt;]&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;标准库更新&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Bundler&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;增加 --ext=rust，支持基于 Rust 扩展的 bundle gem。
[&lt;a href=&quot;https://github.com/rubygems/rubygems/pull/6149&quot;&gt;GH-rubygems-6149&lt;/a&gt;]&lt;/li&gt;
&lt;li&gt;从 git 库克隆代码更快 [&lt;a href=&quot;https://github.com/rubygems/rubygems/pull/4475&quot;&gt;GH-rubygems-4475&lt;/a&gt;]&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;RubyGems&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;增加 cargo builder 的 mswin 支持。 [&lt;a href=&quot;https://github.com/rubygems/rubygems/pull/6167&quot;&gt;GH-rubygems-6167&lt;/a&gt;]&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ERB&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;使 &lt;code&gt;ERB::Util.html_escape&lt;/code&gt; 比 &lt;code&gt;CGI.escapeHTML&lt;/code&gt; 更快。
&lt;ul&gt;
&lt;li&gt;当没有字符需要转义时，不再分配 String 对象。&lt;/li&gt;
&lt;li&gt;当参数已经是 String 时，跳过调用 &lt;code&gt;#to_s&lt;/code&gt; 方法。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;ERB::Escape.html_escape&lt;/code&gt; 作为 &lt;code&gt;ERB::Util.html_escape&lt;/code&gt; 的别名被添加，它还没有被 Rails 作为猴子补丁(monkey-patched)。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;IRB&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;增加 debug.gem 集成命令： &lt;code&gt;debug&lt;/code&gt;，&lt;code&gt;break&lt;/code&gt;，&lt;code&gt;catch&lt;/code&gt;，
&lt;code&gt;next&lt;/code&gt;，&lt;code&gt;delete&lt;/code&gt;，&lt;code&gt;step&lt;/code&gt;，&lt;code&gt;continue&lt;/code&gt;，&lt;code&gt;finish&lt;/code&gt;，&lt;code&gt;backtrace&lt;/code&gt;， &lt;code&gt;info&lt;/code&gt;
&lt;ul&gt;
&lt;li&gt;即使在您的 Gemfile 中没有 &lt;code&gt;gem &amp;quot;debug&amp;quot;&lt;/code&gt;，也可以使用。&lt;/li&gt;
&lt;li&gt;可参考 &lt;a href=&quot;https://st0012.dev/whats-new-in-ruby-3-2-irb&quot;&gt;What's new in Ruby 3.2's IRB?&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;新增更多 Pry-like 命令和特性。
&lt;ul&gt;
&lt;li&gt;新增 &lt;code&gt;edit&lt;/code&gt; 和 &lt;code&gt;show_cmds&lt;/code&gt; (类似 Pry 的 &lt;code&gt;help&lt;/code&gt;)。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;ls&lt;/code&gt; 可以使用 &lt;code&gt;-g&lt;/code&gt; 或 &lt;code&gt;-G&lt;/code&gt; 参数来过滤输出。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;show_source&lt;/code&gt; 是 &lt;code&gt;$&lt;/code&gt; 的别名，且接受未引用输入。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;whereami&lt;/code&gt; 是 &lt;code&gt;@&lt;/code&gt; 的别名。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;下列默认 gems 被更新。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;RubyGems 3.4.1&lt;/li&gt;
&lt;li&gt;abbrev 0.1.1&lt;/li&gt;
&lt;li&gt;benchmark 0.2.1&lt;/li&gt;
&lt;li&gt;bigdecimal 3.1.3&lt;/li&gt;
&lt;li&gt;bundler 2.4.1&lt;/li&gt;
&lt;li&gt;cgi 0.3.6&lt;/li&gt;
&lt;li&gt;csv 3.2.6&lt;/li&gt;
&lt;li&gt;date 3.3.3&lt;/li&gt;
&lt;li&gt;delegate 0.3.0&lt;/li&gt;
&lt;li&gt;did_you_mean 1.6.3&lt;/li&gt;
&lt;li&gt;digest 3.1.1&lt;/li&gt;
&lt;li&gt;drb 2.1.1&lt;/li&gt;
&lt;li&gt;english 0.7.2&lt;/li&gt;
&lt;li&gt;erb 4.0.2&lt;/li&gt;
&lt;li&gt;error_highlight 0.5.1&lt;/li&gt;
&lt;li&gt;etc 1.4.2&lt;/li&gt;
&lt;li&gt;fcntl 1.0.2&lt;/li&gt;
&lt;li&gt;fiddle 1.1.1&lt;/li&gt;
&lt;li&gt;fileutils 1.7.0&lt;/li&gt;
&lt;li&gt;forwardable 1.3.3&lt;/li&gt;
&lt;li&gt;getoptlong 0.2.0&lt;/li&gt;
&lt;li&gt;io-console 0.6.0&lt;/li&gt;
&lt;li&gt;io-nonblock 0.2.0&lt;/li&gt;
&lt;li&gt;io-wait 0.3.0&lt;/li&gt;
&lt;li&gt;ipaddr 1.2.5&lt;/li&gt;
&lt;li&gt;irb 1.6.2&lt;/li&gt;
&lt;li&gt;json 2.6.3&lt;/li&gt;
&lt;li&gt;logger 1.5.3&lt;/li&gt;
&lt;li&gt;mutex_m 0.1.2&lt;/li&gt;
&lt;li&gt;net-http 0.3.2&lt;/li&gt;
&lt;li&gt;net-protocol 0.2.1&lt;/li&gt;
&lt;li&gt;nkf 0.1.2&lt;/li&gt;
&lt;li&gt;open-uri 0.3.0&lt;/li&gt;
&lt;li&gt;open3 0.1.2&lt;/li&gt;
&lt;li&gt;openssl 3.1.0&lt;/li&gt;
&lt;li&gt;optparse 0.3.1&lt;/li&gt;
&lt;li&gt;ostruct 0.5.5&lt;/li&gt;
&lt;li&gt;pathname 0.2.1&lt;/li&gt;
&lt;li&gt;pp 0.4.0&lt;/li&gt;
&lt;li&gt;pstore 0.1.2&lt;/li&gt;
&lt;li&gt;psych 5.0.1&lt;/li&gt;
&lt;li&gt;racc 1.6.2&lt;/li&gt;
&lt;li&gt;rdoc 6.5.0&lt;/li&gt;
&lt;li&gt;readline-ext 0.1.5&lt;/li&gt;
&lt;li&gt;reline 0.3.2&lt;/li&gt;
&lt;li&gt;resolv 0.2.2&lt;/li&gt;
&lt;li&gt;resolv-replace 0.1.1&lt;/li&gt;
&lt;li&gt;securerandom 0.2.2&lt;/li&gt;
&lt;li&gt;set 1.0.3&lt;/li&gt;
&lt;li&gt;stringio 3.0.4&lt;/li&gt;
&lt;li&gt;strscan 3.0.5&lt;/li&gt;
&lt;li&gt;syntax_suggest 1.0.2&lt;/li&gt;
&lt;li&gt;syslog 0.1.1&lt;/li&gt;
&lt;li&gt;tempfile 0.1.3&lt;/li&gt;
&lt;li&gt;time 0.2.1&lt;/li&gt;
&lt;li&gt;timeout 0.3.1&lt;/li&gt;
&lt;li&gt;tmpdir 0.1.3&lt;/li&gt;
&lt;li&gt;tsort 0.1.1&lt;/li&gt;
&lt;li&gt;un 0.2.1&lt;/li&gt;
&lt;li&gt;uri 0.12.0&lt;/li&gt;
&lt;li&gt;weakref 0.1.2&lt;/li&gt;
&lt;li&gt;win32ole 1.8.9&lt;/li&gt;
&lt;li&gt;yaml 0.2.1&lt;/li&gt;
&lt;li&gt;zlib 3.0.0&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;下列绑定 gems 被更新。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;minitest 5.16.3&lt;/li&gt;
&lt;li&gt;power_assert 2.0.3&lt;/li&gt;
&lt;li&gt;test-unit 3.5.7&lt;/li&gt;
&lt;li&gt;net-ftp 0.2.0&lt;/li&gt;
&lt;li&gt;net-imap 0.3.3&lt;/li&gt;
&lt;li&gt;net-pop 0.1.2&lt;/li&gt;
&lt;li&gt;net-smtp 0.3.3&lt;/li&gt;
&lt;li&gt;rbs 2.8.2&lt;/li&gt;
&lt;li&gt;typeprof 0.21.3&lt;/li&gt;
&lt;li&gt;debug 1.7.1&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;可参考 GitHub 的版本页面，例如 &lt;a href=&quot;https://github.com/ruby/logger/releases&quot;&gt;logger 的 GitHub 版本页面&lt;/a&gt; 或通过变更日志获取更详细的 gem 信息。&lt;/p&gt;
&lt;p&gt;您可以通过 &lt;a href=&quot;https://github.com/ruby/ruby/blob/v3_2_0/NEWS.md&quot;&gt;新闻&lt;/a&gt;
或 &lt;a href=&quot;https://github.com/ruby/ruby/compare/v3_1_0...v3_2_0&quot;&gt;提交日志&lt;/a&gt;
获取更多信息。&lt;/p&gt;
&lt;p&gt;自 Ruby 3.1.0 以来，伴随这些变更， &lt;a href=&quot;https://github.com/ruby/ruby/compare/v3_1_0...v3_2_0#file_bucket&quot;&gt;3048 个文件被更改， 新增 218253 行(+)，删除 131067 行(-)&lt;/a&gt;!&lt;/p&gt;
&lt;p&gt;圣诞快乐，节日快乐，享受 Ruby 3.2 编程的快乐时光吧！&lt;/p&gt;
&lt;h2&gt;下载&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&quot;https://cache.ruby-lang.org/pub/ruby/3.2/ruby-3.2.0.tar.gz&quot;&gt;https://cache.ruby-lang.org/pub/ruby/3.2/ruby-3.2.0.tar.gz&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;SIZE: 20440715
SHA1: fb4ab2ceba8bf6a5b9bc7bf7cac945cc94f94c2b
SHA256: daaa78e1360b2783f98deeceb677ad900f3a36c0ffa6e2b6b19090be77abc272
SHA512: 94203051d20475b95a66660016721a0457d7ea57656a9f16cdd4264d8aa6c4cd8ea2fab659082611bfbd7b00ebbcf0391e883e2ebf384e4fab91869e0a877d35
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&quot;https://cache.ruby-lang.org/pub/ruby/3.2/ruby-3.2.0.tar.xz&quot;&gt;https://cache.ruby-lang.org/pub/ruby/3.2/ruby-3.2.0.tar.xz&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;SIZE: 15058364
SHA1: bcdae07183d66fd902cb7bf995545a472d2fefea
SHA256: d2f4577306e6dd932259693233141e5c3ec13622c95b75996541b8d5b68b28b4
SHA512: 733ecc6709470ee16916deeece9af1c76220ae95d17b2681116aff7f381d99bc3124b1b11b1c2336b2b29e468e91b90f158d5ae5fca810c6cf32a0b6234ae08e
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&quot;https://cache.ruby-lang.org/pub/ruby/3.2/ruby-3.2.0.zip&quot;&gt;https://cache.ruby-lang.org/pub/ruby/3.2/ruby-3.2.0.zip&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;SIZE: 24583271
SHA1: 581ec7b9289c2a85abf4f41c93993ecaa5cf43a5
SHA256: cca9ddbc958431ff77f61948cb67afa569f01f99c9389d2bbedfa92986c9ef09
SHA512: b7d2753825cc0667e8bb391fc7ec59a53c3db5fa314e38eee74b6511890b585ac7515baa2ddac09e2c6b6c42b9221c82e040af5b39c73e980fbd3b1bc622c99d
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Ruby是什么&lt;/h2&gt;
&lt;p&gt;Ruby 最初由 Matz （松本行弘，Yukihiro Matsumoto） 于 1993 年开发，现在以开源软件的形式开发。它可以在多个平台上运行，并在全球得到广泛使用，尤其是Web开发领域。&lt;/p&gt;

&lt;p&gt;由 naruse 发表于 2022-12-25&lt;br /&gt;翻译： GAO Jun&lt;/p&gt;</description>
      <pubDate>Sun, 25 Dec 2022 00:00:00 +0000</pubDate>
      <guid>https://www.ruby-lang.org/zh_cn/news/2022/12/25/ruby-3-2-0-released/</guid>
      <link>https://www.ruby-lang.org/zh_cn/news/2022/12/25/ruby-3-2-0-released/</link>
    </item>
    
    <item>
      <title>Ruby 3.2.0 RC 1 已发布</title>
      <description>&lt;p&gt;我们很高兴地宣布 Ruby 3.2.0-rc1。Ruby 3.2 增加了很多新功能和性能改进。&lt;/p&gt;
&lt;h2&gt;基于 WASI 的 WebAssembly 支持&lt;/h2&gt;
&lt;p&gt;这是首次基于 WASI 的 WebAssembly 支持。使得 CRuby 二进制内容可用于浏览器、Serverless Edge、以及其他 WebAssembly/WASI 嵌入环境。目前，此功能已通过除 Thread API 之外的 basic 和 bootstrap 测试套件。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://i.imgur.com/opCgKy2.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
&lt;h3&gt;背景&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;https://webassembly.org/&quot;&gt;WebAssembly (Wasm)&lt;/a&gt; 希望能够在浏览器中提供安全快速的运行程序的方式。但其目标，也就是在不同环境中安全高效的运行程序，不仅是 web 应用长期以来的目标，也是其他一般程序所需要的。&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://wasi.dev/&quot;&gt;WASI (The WebAssembly System Interface)&lt;/a&gt; 被设计用于此类应用场景。尽管此类应用需要与操作系统进行通信，WebAssembly 却运行在一个没有系统接口的虚拟机之上。WASI 使之标准化。&lt;/p&gt;
&lt;p&gt;基于这些项目，Ruby 的 WebAssembly/WASI 支持能使 Ruby 开发者可以编写能运行于兼容此类功能的平台上。&lt;/p&gt;
&lt;h3&gt;应用场景&lt;/h3&gt;
&lt;p&gt;此功能使得开发人员可以在 WebAssembly 环境中使用 CRuby。一个此类应用场景的案例是 &lt;a href=&quot;https://try.ruby-lang.org/playground/&quot;&gt;TryRuby playground&lt;/a&gt; 的 CRuby 支持。现在您可以在您的浏览器中尝试原生的 CRuby。&lt;/p&gt;
&lt;h3&gt;技术要点&lt;/h3&gt;
&lt;p&gt;目前，WASI 和 WebAssembly 仍在不断演进，同时基于安全原因，还缺少一些功能来实现纤程、异常和垃圾回收。
所以，CRuby 使用了一种可以控制用户空间中执行的二进制转换技术 Asyncify 来填补这一鸿沟。&lt;/p&gt;
&lt;p&gt;此外，我们创建了 &lt;a href=&quot;https://github.com/kateinoigakukun/wasi-vfs/wiki/Getting-Started-with-CRuby&quot;&gt;WASI 之上的虚拟文件系统&lt;/a&gt;，于是就可以很容易地将 Ruby 应用打包成单个 .wasm 文件，进而简化分发 Ruby 应用的过程。&lt;/p&gt;
&lt;h3&gt;相关链接&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/ruby/ruby/pull/5407&quot;&gt;Add WASI based WebAssembly support #5407&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://itnext.io/final-report-webassembly-wasi-support-in-ruby-4aface7d90c9&quot;&gt;An Update on WebAssembly/WASI Support in Ruby&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Regexp 用于防御 ReDoS 攻击的改进&lt;/h2&gt;
&lt;p&gt;众所周知，正则表达式匹配的耗时可能出乎意料的长。如果您的代码尝试从一个不可信输入中匹配一个低效的正则表达式，攻击者可以借此发起有效的拒绝服务攻击(所谓的正则表达式 DoS，或 ReDoS)。&lt;/p&gt;
&lt;p&gt;我们引入了2个更新，能够显著减轻 ReDoS 的影响&lt;/p&gt;
&lt;h3&gt;改进 Regexp 匹配算法&lt;/h3&gt;
&lt;p&gt;自 Ruby 3.2 开始，Regexp 的匹配算法通过缓存技术得到了显著改进。
新增正则表达式匹配的超时设置。&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# 下面的正则匹配在 Ruby 3.1 中耗时10秒，在 Ruby 3.2 中耗时0.003秒

/^a*b?a*$/ =~ &quot;a&quot; * 50000 + &quot;x&quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;https://cache.ruby-lang.org/pub/media/ruby320_regex_1.png&quot; alt=&quot;&quot; /&gt;
&lt;img src=&quot;https://cache.ruby-lang.org/pub/media/ruby320_regex_2.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
&lt;p&gt;通过改进的匹配算法，使得 Regexp 的匹配（根据我们的实验，约90%）能够在线性时间内完成。&lt;/p&gt;
&lt;p&gt;（致 Preview 用户：此改进可能会消耗与每个匹配的输入长度成比例的内存。我们预计不会出现实际问题，因为这种内存分配通常会延迟，并且正常的 Regexp 匹配最多只会消耗表达式长度10倍的内存。如果您在实际应用中遇到 Regexp 匹配导致的内存不足情况，请报告给我们。）&lt;/p&gt;
&lt;p&gt;最初提议 &lt;a href=&quot;https://bugs.ruby-lang.org/issues/19104&quot;&gt;https://bugs.ruby-lang.org/issues/19104&lt;/a&gt;&lt;/p&gt;
&lt;h3&gt;Regexp 超时设置&lt;/h3&gt;
&lt;p&gt;上面的改进不能使用于某些正则表达式，比如使用了某些高级特性（例如：反向引用 back-references，环视 look-around），或者大量使用固定重复次数。作为一种后备措施，Regexp 还引入了超时设置功能。&lt;/p&gt;
&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;no&quot;&gt;Regexp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;timeout&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.0&lt;/span&gt;

&lt;span class=&quot;sr&quot;&gt;/^a*b?a*()\1$/&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=~&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;a&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;50000&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;x&quot;&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#=&amp;gt; 1秒后 Regexp::TimeoutError&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;请注意，&lt;code&gt;Regexp.timeout&lt;/code&gt; 是全局性的配置。如果您希望对于某些特殊的正则表达式使用不同的超时设置，您可以使用 &lt;code&gt;Regexp.new&lt;/code&gt; 中的 &lt;code&gt;timeout&lt;/code&gt; 关键词。&lt;/p&gt;
&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;no&quot;&gt;Regexp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;timeout&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.0&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# 这个 Regexp 没有超时设置&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;long_time_re&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Regexp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;^a*b?a*()&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\1&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;$&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;timeout: &lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Float&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;INFINITY&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;long_time_re&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=~&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;a&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;50000&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;x&quot;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# 不会被中断&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;最初提议：&lt;a href=&quot;https://bugs.ruby-lang.org/issues/17837&quot;&gt;https://bugs.ruby-lang.org/issues/17837&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;其他值得注意的新功能&lt;/h2&gt;
&lt;h3&gt;语法建议&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;syntax_suggest&lt;/code&gt;（曾用名 &lt;code&gt;dead_end&lt;/code&gt;）的功能已被集成到 Ruby。这可以帮助您找到错误的位置，例如缺失或多余的 &lt;code&gt;end&lt;/code&gt;，让您更快地修正错误，例如下面的例子：&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Unmatched `end', missing keyword (`do', `def`, `if`, etc.) ?

  1  class Dog
&amp;gt; 2    defbark
&amp;gt; 4    end
  5  end
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;[&lt;a href=&quot;https://bugs.ruby-lang.org/issues/18159&quot;&gt;Feature #18159&lt;/a&gt;]&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;错误提示&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;现在，在 TypeError 和 ArgumentError 中将指出出错的参数&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;test.rb:2:in `+': nil can't be coerced into Integer (TypeError)

sum = ary[0] + ary[1]
               ^^^^^^
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;h3&gt;语言&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;除了在方法参数中使用，匿名的可变长参数现在可以作为参数进行传递
[&lt;a href=&quot;https://bugs.ruby-lang.org/issues/18351&quot;&gt;Feature #18351&lt;/a&gt;]&lt;/p&gt;
&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;foo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;bar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;baz&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;quux&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;接受一个单独位置参数的 proc 不再会自动解封装。 [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/18633&quot;&gt;Bug #18633&lt;/a&gt;]&lt;/p&gt;
&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;nb&quot;&gt;proc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;call&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Ruby 3.1 及之前版本&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# =&amp;gt; 1&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Ruby 3.2 及之后版本&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# =&amp;gt; [1, 2]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;对于显示对象的常量赋值求值顺序，将始终使用单属性赋值求值顺序。参考下面的代码:&lt;/p&gt;
&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;n&quot;&gt;foo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;BAR&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;baz&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;code&gt;foo&lt;/code&gt; 现在在 &lt;code&gt;baz&lt;/code&gt; 之前求值。类似的，对于多重常量的赋值，使用从左到右的求值顺序。参考下面的代码:&lt;/p&gt;
&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code data-lang=&quot;ruby&quot;&gt;  &lt;span class=&quot;n&quot;&gt;foo1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;BAR1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;foo2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;BAR2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;baz1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;baz2&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;现在使用下面的求值顺序:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code&gt;foo1&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;foo2&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;baz1&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;baz2&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;[&lt;a href=&quot;https://bugs.ruby-lang.org/issues/15928&quot;&gt;Bug #15928&lt;/a&gt;]&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;查找模式不再是实验性功能。
[&lt;a href=&quot;https://bugs.ruby-lang.org/issues/18585&quot;&gt;Feature #18585&lt;/a&gt;]&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;使用可变长参数 (例如 &lt;code&gt;*args&lt;/code&gt;) 的方法，如果同时希望通过 &lt;code&gt;foo(*args)&lt;/code&gt; 使用关键词参数的，那么必须使用 &lt;code&gt;ruby2_keywords&lt;/code&gt; 进行标记。也就是说，所有希望通过 &lt;code&gt;*args&lt;/code&gt; 来使用关键字参数的方法现在毫无例外地都必须使用
&lt;code&gt;ruby2_keywords&lt;/code&gt; 进行标记。一旦某个库需要 Ruby 3+，这将是一个更容易的过渡升级方式。此前，当接收方法使用 &lt;code&gt;*args&lt;/code&gt; 时，&lt;code&gt;ruby2_keywords&lt;/code&gt; 标记被保留，但这可能是错误并且是行为不一致的。对于查找潜在缺失的
&lt;code&gt;ruby2_keywords&lt;/code&gt; 的好方法应当是运行测试套件，检查测试失败时调用的最后一个方法，这个方法必须接收关键词参数。通过在错误处使用 &lt;code&gt;puts nil, caller, nil&lt;/code&gt;，然后检查在调用链上的每一个使用自动委派关键词的方法/块被标记为
&lt;code&gt;ruby2_keywords&lt;/code&gt;。 [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/18625&quot;&gt;Bug #18625&lt;/a&gt;] [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/16466&quot;&gt;Bug #16466&lt;/a&gt;]&lt;/p&gt;
&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;target&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;kw&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Ruby 2.7-3.1 可以意外地在没有 ruby2_keywords 的情况下执行，在 3.2 中必需。&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# 如需去除 ruby2_keywords，需要修改 #foo 和 #bar 的参数为 (*args, **kwargs) 或 (...)。&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ruby2_keywords&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;bar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;target&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;ruby2_keywords&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;foo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;bar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;foo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;k: &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;性能改进&lt;/h2&gt;
&lt;h3&gt;YJIT&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;YJIT 现在支持 x86-64 和 arm64/aarch64 CPU，以及 Linux，MacOS，BSD 和其他 UNIX 平台。
&lt;ul&gt;
&lt;li&gt;此次发布带来了 Mac M1/M2，AWS Graviton 和 Raspberry Pi 4 ARM64 处理器支持。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;编译 YJIT 需要 Rust 1.58.1+. [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/18481&quot;&gt;Feature #18481&lt;/a&gt;]
&lt;ul&gt;
&lt;li&gt;为确保 CRuby 中包含了 YJIT，请安装 rustc &amp;gt;= 1.58.0 然后在运行 &lt;code&gt;./configure&lt;/code&gt; 时使用 &lt;code&gt;--enable-yjit&lt;/code&gt; 参数。&lt;/li&gt;
&lt;li&gt;当遇到问题时，您可以联系 YJIT 小组。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;JIT 代码的无力内存是延迟分配的。不同于 Ruby 3.1，Ruby 进程的 RSS 被最小化，因为由 &lt;code&gt;--yjit-exec-mem-size&lt;/code&gt;
分配的虚拟内存页在 JIT 代码实际使用之前不会映射到无力内存页。&lt;/li&gt;
&lt;li&gt;引入 Code GC，当 JIT 代码消耗的内存达到 &lt;code&gt;--yjit-exec-mem-size&lt;/code&gt; 时，释放所有代码页。
&lt;ul&gt;
&lt;li&gt;除了现有的 &lt;code&gt;inline_code_size&lt;/code&gt; 和 &lt;code&gt;outlined_code_size&lt;/code&gt; 指标外，RubyVM::YJIT.runtime_stats 还返回 Code GC 指标：
&lt;code&gt;code_gc_count&lt;/code&gt;，&lt;code&gt;live_page_count&lt;/code&gt;，&lt;code&gt;freed_page_count&lt;/code&gt; 和 &lt;code&gt;freed_code_size&lt;/code&gt;。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;RubyVM::YJIT.runtime_stats 生成的大部分统计数据现在可以在本发布中使用。
&lt;ul&gt;
&lt;li&gt;只需要在运行时加上 &lt;code&gt;--yjit-stats&lt;/code&gt; 即可计算统计信息（会产生一些运行时开销）。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;YJIT 现在进行了优化，可以有效利用对象的形状。[&lt;a href=&quot;https://bugs.ruby-lang.org/issues/18776&quot;&gt;Feature #18776&lt;/a&gt;]&lt;/li&gt;
&lt;li&gt;在定义新常量时，利用更细粒度的常量失效来使更少的代码无效。[&lt;a href=&quot;https://bugs.ruby-lang.org/issues/18589&quot;&gt;Feature #18589&lt;/a&gt;]&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;MJIT&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;MJIT 编译器在 Ruby 中以 &lt;code&gt;mjit&lt;/code&gt; 标准库重新实现。&lt;/li&gt;
&lt;li&gt;MJIT 编译器在分叉的(forked) Ruby 进程中执行，不再以 MJIT worker 的本地线程中执行。[[Feature #18968]]
&lt;ul&gt;
&lt;li&gt;由此，不再支持 Microsoft Visual Studio (MSWIN)。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;不再支持 MinGW。[[Feature #18824]]&lt;/li&gt;
&lt;li&gt;&lt;code&gt;--mjit-min-calls&lt;/code&gt; 更名为 &lt;code&gt;--mjit-call-threshold&lt;/code&gt;。&lt;/li&gt;
&lt;li&gt;将 &lt;code&gt;--mjit-max-cache&lt;/code&gt; 的默认值从 10000 修改回 100。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;PubGrub&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Bundler 2.4 现在使用 &lt;a href=&quot;https://github.com/jhawthorn/pub_grub&quot;&gt;PubGrub&lt;/a&gt; 来替换 &lt;a href=&quot;https://github.com/CocoaPods/Molinillo&quot;&gt;Molinillo&lt;/a&gt; 进行依赖解析。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;PubGrub 是 Dart 语言的 &lt;code&gt;pub&lt;/code&gt; 包管理器使用的新一代解析算法。&lt;/li&gt;
&lt;li&gt;在此次变更后，您可能会得到不同的解析结果。请将此类问题报告到 &lt;a href=&quot;https://github.com/rubygems/rubygems/issues&quot;&gt;RubyGems/Bundler 问题&lt;/a&gt;。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;RubyGems 在 Ruby 3.2 中依旧使用 Molinillo。我们计划在将来用 PubGrub 进行替换。&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;自 3.1 以来其他值得注意的变更&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Hash&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;当 hash 为空时，Hash#shift 现在总是返回 nil，此前行为是返回默认值或调用默认 proc。 [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/16908&quot;&gt;Bug #16908&lt;/a&gt;]&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;MatchData&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;新增 MatchData#byteoffset 。 [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/13110&quot;&gt;Feature #13110&lt;/a&gt;]&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Module&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;新增 Module.used_refinements 。 [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/14332&quot;&gt;Feature #14332&lt;/a&gt;]&lt;/li&gt;
&lt;li&gt;新增 Module#refinements 。 [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/12737&quot;&gt;Feature #12737&lt;/a&gt;]&lt;/li&gt;
&lt;li&gt;新增 Module#const_added 。 [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/17881&quot;&gt;Feature #17881&lt;/a&gt;]&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Proc&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Proc#dup 返回子类的一个实例。 [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/17545&quot;&gt;Bug #17545&lt;/a&gt;]&lt;/li&gt;
&lt;li&gt;Proc#parameters 现在接受 lambda 关键字。 [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/15357&quot;&gt;Feature #15357&lt;/a&gt;]&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Refinement&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;新增 Refinement#refined_class。 [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/12737&quot;&gt;Feature #12737&lt;/a&gt;]&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;RubyVM::AbstractSyntaxTree&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;为&lt;code&gt;parse&lt;/code&gt;, &lt;code&gt;parse_file&lt;/code&gt; 和 &lt;code&gt;of&lt;/code&gt; 增加选项 &lt;code&gt;error_tolerant&lt;/code&gt;。 [[Feature #19013]]&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Set&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Set 现在可以直接使用，不需要调用 &lt;code&gt;require &amp;quot;set&amp;quot;&lt;/code&gt;。 [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/16989&quot;&gt;Feature #16989&lt;/a&gt;]
目前其通过 &lt;code&gt;Set&lt;/code&gt; 常量或对 &lt;code&gt;Enumerable#to_set&lt;/code&gt; 调用自动载入。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;String&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;新增 String#byteindex 和 String#byterindex 。 [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/13110&quot;&gt;Feature #13110&lt;/a&gt;]&lt;/li&gt;
&lt;li&gt;更新 Unicode 至 Version 15.0.0，Emoji Version 15.0. [[Feature #18037]] (同样适用于 Regexp)&lt;/li&gt;
&lt;li&gt;新增 String#bytesplice 。  [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/18598&quot;&gt;Feature #18598&lt;/a&gt;]&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Struct&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;即使在 &lt;code&gt;Struct.new&lt;/code&gt; 中不设置 &lt;code&gt;keyword_init: true&lt;/code&gt;，Struct 类也可以通过关键词参数进行初始化。 [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/16806&quot;&gt;Feature #16806&lt;/a&gt;]&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;兼容性问题&lt;/h2&gt;
&lt;p&gt;注意：不包含特性的问题修正&lt;/p&gt;
&lt;h3&gt;被移除的常量&lt;/h3&gt;
&lt;p&gt;下列废弃常量被移除。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;Fixnum&lt;/code&gt; 与 &lt;code&gt;Bignum&lt;/code&gt; [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/12005&quot;&gt;Feature #12005&lt;/a&gt;]&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Random::DEFAULT&lt;/code&gt; [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/17351&quot;&gt;Feature #17351&lt;/a&gt;]&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Struct::Group&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Struct::Passwd&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;被移除的方法&lt;/h3&gt;
&lt;p&gt;下列废弃方法被移除。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;Dir.exists?&lt;/code&gt; [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/17391&quot;&gt;Feature #17391&lt;/a&gt;]&lt;/li&gt;
&lt;li&gt;&lt;code&gt;File.exists?&lt;/code&gt; [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/17391&quot;&gt;Feature #17391&lt;/a&gt;]&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Kernel#=~&lt;/code&gt; [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/15231&quot;&gt;Feature #15231&lt;/a&gt;]&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Kernel#taint&lt;/code&gt;, &lt;code&gt;Kernel#untaint&lt;/code&gt;, &lt;code&gt;Kernel#tainted?&lt;/code&gt;
[&lt;a href=&quot;https://bugs.ruby-lang.org/issues/16131&quot;&gt;Feature #16131&lt;/a&gt;]&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Kernel#trust&lt;/code&gt;, &lt;code&gt;Kernel#untrust&lt;/code&gt;, &lt;code&gt;Kernel#untrusted?&lt;/code&gt;
[&lt;a href=&quot;https://bugs.ruby-lang.org/issues/16131&quot;&gt;Feature #16131&lt;/a&gt;]&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;标准库兼容性问题&lt;/h2&gt;
&lt;h3&gt;不再捆绑第三方源代码&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;我们不再捆绑第三方源代码，例如 &lt;code&gt;libyaml&lt;/code&gt;， &lt;code&gt;libffi&lt;/code&gt;。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;psych 中已经移除了 libyaml 的代码。您可能需要在 Ubuntu/Debian 平台中安装 &lt;code&gt;libyaml-dev&lt;/code&gt;。软件包的名称可能因平台不同而各异。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;从 &lt;code&gt;fiddle&lt;/code&gt; 中移除捆绑的 libffi 源码&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Psych 和 fiddle 支持指定 libyaml 和 libffi 的版本来静态编译。您可以像这样基于 libyaml-0.2.5 编译 psych：&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;./configure &lt;span class=&quot;nt&quot;&gt;--with-libyaml-source-dir&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/path/to/libyaml-0.2.5
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;同样，您可以像这样基于 libffi-3.4.4 编译 fiddle：&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;./configure &lt;span class=&quot;nt&quot;&gt;--with-libffi-source-dir&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/path/to/libffi-3.4.4
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;[&lt;a href=&quot;https://bugs.ruby-lang.org/issues/18571&quot;&gt;Feature #18571&lt;/a&gt;]&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;C API 更新&lt;/h2&gt;
&lt;h3&gt;更新的 C API&lt;/h3&gt;
&lt;p&gt;下列 API 被更新。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;PRNG 更新
&lt;code&gt;rb_random_interface_t&lt;/code&gt; 被更新并设定版本。
如果扩展库使用旧版本的接口需要更新。
同样，&lt;code&gt;init_int32&lt;/code&gt; 函数需要被定义。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;被移除的 C API&lt;/h3&gt;
&lt;p&gt;下列废弃的 API 被移除。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;变量 &lt;code&gt;rb_cData&lt;/code&gt;。&lt;/li&gt;
&lt;li&gt;&amp;quot;taintedness&amp;quot; 与 &amp;quot;trustedness&amp;quot; 函数。 [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/16131&quot;&gt;Feature #16131&lt;/a&gt;]&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;标准库更新&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;下列默认 gems 被更新。
&lt;ul&gt;
&lt;li&gt;RubyGems 3.4.0.dev&lt;/li&gt;
&lt;li&gt;benchmark 0.2.1&lt;/li&gt;
&lt;li&gt;bigdecimal 3.1.3&lt;/li&gt;
&lt;li&gt;bundler 2.4.0.dev&lt;/li&gt;
&lt;li&gt;cgi 0.3.6&lt;/li&gt;
&lt;li&gt;date 3.3.0&lt;/li&gt;
&lt;li&gt;delegate 0.3.0&lt;/li&gt;
&lt;li&gt;did_you_mean 1.6.2&lt;/li&gt;
&lt;li&gt;digest 3.1.1&lt;/li&gt;
&lt;li&gt;drb 2.1.1&lt;/li&gt;
&lt;li&gt;erb 4.0.2&lt;/li&gt;
&lt;li&gt;error_highlight 0.5.1&lt;/li&gt;
&lt;li&gt;etc 1.4.1&lt;/li&gt;
&lt;li&gt;fcntl 1.0.2&lt;/li&gt;
&lt;li&gt;fiddle 1.1.1&lt;/li&gt;
&lt;li&gt;fileutils 1.7.0&lt;/li&gt;
&lt;li&gt;forwardable 1.3.3&lt;/li&gt;
&lt;li&gt;getoptlong 0.2.0&lt;/li&gt;
&lt;li&gt;io-console 0.5.11&lt;/li&gt;
&lt;li&gt;io-nonblock 0.2.0&lt;/li&gt;
&lt;li&gt;io-wait 0.3.0.pre&lt;/li&gt;
&lt;li&gt;ipaddr 1.2.5&lt;/li&gt;
&lt;li&gt;irb 1.5.1&lt;/li&gt;
&lt;li&gt;json 2.6.2&lt;/li&gt;
&lt;li&gt;logger 1.5.2&lt;/li&gt;
&lt;li&gt;mutex_m 0.1.2&lt;/li&gt;
&lt;li&gt;net-http 0.3.1&lt;/li&gt;
&lt;li&gt;net-protocol 0.2.0&lt;/li&gt;
&lt;li&gt;nkf 0.1.2&lt;/li&gt;
&lt;li&gt;open-uri 0.3.0&lt;/li&gt;
&lt;li&gt;openssl 3.1.0.pre&lt;/li&gt;
&lt;li&gt;optparse 0.3.0&lt;/li&gt;
&lt;li&gt;ostruct 0.5.5&lt;/li&gt;
&lt;li&gt;pathname 0.2.1&lt;/li&gt;
&lt;li&gt;pp 0.4.0&lt;/li&gt;
&lt;li&gt;pstore 0.1.2&lt;/li&gt;
&lt;li&gt;psych 5.0.0&lt;/li&gt;
&lt;li&gt;racc 1.6.1&lt;/li&gt;
&lt;li&gt;rdoc 6.5.0&lt;/li&gt;
&lt;li&gt;reline 0.3.1&lt;/li&gt;
&lt;li&gt;resolv 0.2.2&lt;/li&gt;
&lt;li&gt;securerandom 0.2.1&lt;/li&gt;
&lt;li&gt;set 1.0.3&lt;/li&gt;
&lt;li&gt;stringio 3.0.3&lt;/li&gt;
&lt;li&gt;syntax_suggest 1.0.1&lt;/li&gt;
&lt;li&gt;timeout 0.3.1&lt;/li&gt;
&lt;li&gt;tmpdir 0.1.3&lt;/li&gt;
&lt;li&gt;tsort 0.1.1&lt;/li&gt;
&lt;li&gt;un 0.2.1&lt;/li&gt;
&lt;li&gt;uri 0.12.0&lt;/li&gt;
&lt;li&gt;win32ole 1.8.9&lt;/li&gt;
&lt;li&gt;zlib 3.0.0&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;下列绑定 gems 被更新。
&lt;ul&gt;
&lt;li&gt;minitest 5.16.3&lt;/li&gt;
&lt;li&gt;power_assert 2.0.2&lt;/li&gt;
&lt;li&gt;test-unit 3.5.5&lt;/li&gt;
&lt;li&gt;net-ftp 0.2.0&lt;/li&gt;
&lt;li&gt;net-imap 0.3.1&lt;/li&gt;
&lt;li&gt;net-pop 0.1.2&lt;/li&gt;
&lt;li&gt;net-smtp 0.3.3&lt;/li&gt;
&lt;li&gt;rbs 2.8.1&lt;/li&gt;
&lt;li&gt;typeprof 0.21.3&lt;/li&gt;
&lt;li&gt;debug 1.7.0&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;您可以通过 &lt;a href=&quot;https://github.com/ruby/ruby/blob/v3_2_0_rc1/NEWS.md&quot;&gt;新闻&lt;/a&gt;
或 &lt;a href=&quot;https://github.com/ruby/ruby/compare/v3_1_0...v3_2_0_rc1&quot;&gt;提交日志&lt;/a&gt;
获取更多信息。&lt;/p&gt;
&lt;p&gt;自 Ruby 3.1.0 以来，伴随这些变更， &lt;a href=&quot;https://github.com/ruby/ruby/compare/v3_1_0...v3_2_0_rc1#file_bucket&quot;&gt;2846 个文件被更改， 新增 203950 行(+)，删除 127153 行(-)&lt;/a&gt;!&lt;/p&gt;
&lt;h2&gt;下载&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&quot;https://cache.ruby-lang.org/pub/ruby/3.2/ruby-3.2.0-rc1.tar.gz&quot;&gt;https://cache.ruby-lang.org/pub/ruby/3.2/ruby-3.2.0-rc1.tar.gz&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;SIZE: 20253652
SHA1: 9b45af61ef1ae3c21ab88d7c9e30b80060116ac3
SHA256: 3bb9760c1ac1b66416aaa4899809f6ccd010e57038eaaeca19a383fd56275dac
SHA512: 798157d785ebae94cb128d3c134fa35e0e90c654972e531cb6562823042f3fb68a270226f7b1cf0c42572ef2b1488a1a3e44f88389ad2a6f9ca4b280a2a8e759
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&quot;https://cache.ruby-lang.org/pub/ruby/3.2/ruby-3.2.0-rc1.tar.xz&quot;&gt;https://cache.ruby-lang.org/pub/ruby/3.2/ruby-3.2.0-rc1.tar.xz&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;SIZE: 14934012
SHA1: 5576e304786d466410f27a345dc1cb66f2c773f6
SHA256: 0d45b3af14e84337882a2021235a091ae5dcfc0baaf31dccc479b71d96dd07bc
SHA512: d38fcb1e09eb9984f3b2347e65ae7406129c2578d068a25d33b5b4f021ec3b567a9abe56c2acbec6d07a3c2b4bc7b485dbd330cbfbb3a96350f60a2bb94d016e
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&quot;https://cache.ruby-lang.org/pub/ruby/3.2/ruby-3.2.0-rc1.zip&quot;&gt;https://cache.ruby-lang.org/pub/ruby/3.2/ruby-3.2.0-rc1.zip&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;SIZE: 24473024
SHA1: 8fdc85363ce61e0b8f04da36e709d49028d04a75
SHA256: 7ff32473be108534548e401aaa9092c37a27f73323ea4091c33901c714c87ee5
SHA512: 07adf6a9c89fdcf420e7b131f40f2b1f4aca036aa6f28539ade26ca552f84a75e0698f77a8b774d2ea52b8c756c4982ef319bda5afa786c081a31dd9873c5ef7
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Ruby是什么&lt;/h2&gt;
&lt;p&gt;Ruby 最初由 Matz （松本行弘，Yukihiro Matsumoto） 于 1993 年开发，现在以开源软件的形式开发。它可以在多个平台上运行，并在全球得到广泛使用，尤其是Web开发领域。&lt;/p&gt;

&lt;p&gt;由 naruse 发表于 2022-12-06&lt;br /&gt;翻译： GAO Jun&lt;/p&gt;</description>
      <pubDate>Tue, 06 Dec 2022 00:00:00 +0000</pubDate>
      <guid>https://www.ruby-lang.org/zh_cn/news/2022/12/06/ruby-3-2-0-rc1-released/</guid>
      <link>https://www.ruby-lang.org/zh_cn/news/2022/12/06/ruby-3-2-0-rc1-released/</link>
    </item>
    
    <item>
      <title>Ruby 3.1.3 已发布</title>
      <description>&lt;p&gt;Ruby 3.1.3 已发布。&lt;/p&gt;
&lt;p&gt;此版本包括一个安全补丁。
请通过以下条目来获取详情。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;/zh_cn/news/2022/11/22/http-response-splitting-in-cgi-cve-2021-33621/&quot;&gt;CVE-2021-33621: CVE-2021-33621: CGI 中的 HTTP 响应拆分漏洞&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;此版本还修正了 macOS 13 (Ventura) 中 Xcode 14 的编译失败问题。
您可以查看 &lt;a href=&quot;https://bugs.ruby-lang.org/issues/18912&quot;&gt;相关问题记录&lt;/a&gt; 获取更多信息。&lt;/p&gt;
&lt;p&gt;您可以通过 &lt;a href=&quot;https://github.com/ruby/ruby/compare/v3_1_2...v3_1_3&quot;&gt;提交日志&lt;/a&gt; 获取更多信息。&lt;/p&gt;
&lt;h2&gt;下载&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&quot;https://cache.ruby-lang.org/pub/ruby/3.1/ruby-3.1.3.tar.gz&quot;&gt;https://cache.ruby-lang.org/pub/ruby/3.1/ruby-3.1.3.tar.gz&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;文件大小: 20906051
SHA1: bd35f56a1cc1760ea582c67cbf669556dc7ae2fd
SHA256: 5ea498a35f4cd15875200a52dde42b6eb179e1264e17d78732c3a57cd1c6ab9e
SHA512: 550cfda2ae492312009a58316e18fd77ea92852718b37443bcd76aac84ba6694fb841fe19bf23bee099f96f5aeed9d03e77c8c02fb194e414eca5f707adbbf90
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&quot;https://cache.ruby-lang.org/pub/ruby/3.1/ruby-3.1.3.tar.xz&quot;&gt;https://cache.ruby-lang.org/pub/ruby/3.1/ruby-3.1.3.tar.xz&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;文件大小: 15300224
SHA1: 12998178c3d17fa8a9d8300c7caab460b0e698c0
SHA256: 4ee161939826bcdfdafa757cf8e293a7f14e357f62be7144f040335cc8c7371a
SHA512: 4b0fd334ae56132ba98b8a69adad54bdcf7f7aeabd5eba5b0f0399a3868e2054f9026ca1b1cb2dbb197a9e9b0610b263481949c0623a62071546bc5adff8ca69
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&quot;https://cache.ruby-lang.org/pub/ruby/3.1/ruby-3.1.3.zip&quot;&gt;https://cache.ruby-lang.org/pub/ruby/3.1/ruby-3.1.3.zip&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;文件大小: 25226279
SHA1: fdc6186085b78536936dff7141e5d0f6fbdfe3bb
SHA256: 9e5de00a1d259a2c6947605825ecf6742d5216bd389af28f9ed366854e59b09e
SHA512: 3901380a27157639dee72f80231790886d269cc741a6c9e0f6472554855be86bdb93f71577ed8d93e817ef0c8d9a168fcd6f6d426fabb465dd0dd22b5a56cfc9
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;版本说明&lt;/h2&gt;
&lt;p&gt;许多提交者、开发人员以及用户提供了问题报告，帮助我们完成了此版本。
感谢他们的贡献。&lt;/p&gt;

&lt;p&gt;由 nagachika 发表于 2022-11-24&lt;br /&gt;翻译： GAO Jun&lt;/p&gt;</description>
      <pubDate>Thu, 24 Nov 2022 12:00:00 +0000</pubDate>
      <guid>https://www.ruby-lang.org/zh_cn/news/2022/11/24/ruby-3-1-3-released/</guid>
      <link>https://www.ruby-lang.org/zh_cn/news/2022/11/24/ruby-3-1-3-released/</link>
    </item>
    
    <item>
      <title>Ruby 3.0.5 已发布</title>
      <description>&lt;p&gt;Ruby 3.0.5 已发布。&lt;/p&gt;
&lt;p&gt;此版本包括一个安全补丁。
请通过以下条目来获取详情。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;/zh_cn/news/2022/11/22/http-response-splitting-in-cgi-cve-2021-33621/&quot;&gt;CVE-2021-33621: CVE-2021-33621: CGI 中的 HTTP 响应拆分漏洞&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;此版本还包括一些补丁。
您可以通过 &lt;a href=&quot;https://github.com/ruby/ruby/compare/v3_0_4...v3_0_5&quot;&gt;提交日志&lt;/a&gt; 获取更多信息。&lt;/p&gt;
&lt;h2&gt;下载&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&quot;https://cache.ruby-lang.org/pub/ruby/3.0/ruby-3.0.5.tar.gz&quot;&gt;https://cache.ruby-lang.org/pub/ruby/3.0/ruby-3.0.5.tar.gz&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;文件大小: 21312118
SHA1: 95e69c79c0cf173f87727b76994ddf0725d5fafc
SHA256: 9afc6380a027a4fe1ae1a3e2eccb6b497b9c5ac0631c12ca56f9b7beb4848776
SHA512: ea45fcd2ca53b87f18fd8696d00a1e340d2495443216aaf87d3f643cb5bd8bb614a1faacd82d07e7f2b72172397c728316a82d7c34a7b4566191268ea517ccf7
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&quot;https://cache.ruby-lang.org/pub/ruby/3.0/ruby-3.0.5.tar.xz&quot;&gt;https://cache.ruby-lang.org/pub/ruby/3.0/ruby-3.0.5.tar.xz&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;文件大小: 15880196
SHA1: 844ede3938c652f5f9bf5dbf1b99f5a6c41b11b6
SHA256: cf7cb5ba2030fe36596a40980cdecfd79a0337d35860876dc2b10a38675bddde
SHA512: 1c69d18210a2156f7696c678a8d54bf05c4dc49a1401c1ecc5760b1c23fb6ac14053873a225564664d6a327cda274ce72f47d112a6ad8d378f978de4e507e9a0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&quot;https://cache.ruby-lang.org/pub/ruby/3.0/ruby-3.0.5.zip&quot;&gt;https://cache.ruby-lang.org/pub/ruby/3.0/ruby-3.0.5.zip&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;文件大小: 25691385
SHA1: 5511c7b30e203ff0b3528453898b62781e97154b
SHA256: 4b63c59ebdc0abcea139a561d67dfa9770af2d9619390f34b8a53f9625a1090d
SHA512: 953cef1dd97395e04059cc76ee2a74348f2c9da0b2727c5406af26e88072e8c0bde91835354cb9f1b44f3a81a49ea7b807d7f048d138fd74ba3cabbf7859f2b3
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;版本说明&lt;/h2&gt;
&lt;p&gt;许多提交者、开发人员以及用户提供了问题报告，帮助我们完成了此版本。
感谢他们的贡献。&lt;/p&gt;
&lt;p&gt;包括这个版本在内的 Ruby 3.0 的维护，都基于 Ruby 协会 (Ruby Association) 的“Ruby 稳定版协议(Agreement for the Ruby stable version)”。&lt;/p&gt;

&lt;p&gt;由 usa 发表于 2022-11-24&lt;br /&gt;翻译： GAO Jun&lt;/p&gt;</description>
      <pubDate>Thu, 24 Nov 2022 12:00:00 +0000</pubDate>
      <guid>https://www.ruby-lang.org/zh_cn/news/2022/11/24/ruby-3-0-5-released/</guid>
      <link>https://www.ruby-lang.org/zh_cn/news/2022/11/24/ruby-3-0-5-released/</link>
    </item>
    
    <item>
      <title>Ruby 2.7.7 已发布</title>
      <description>&lt;p&gt;Ruby 2.7.7 已发布。&lt;/p&gt;
&lt;p&gt;此版本包括一个安全补丁。
请通过以下条目来获取详情。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;/zh_cn/news/2022/11/22/http-response-splitting-in-cgi-cve-2021-33621/&quot;&gt;CVE-2021-33621: CVE-2021-33621: CGI 中的 HTTP 响应拆分漏洞&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;此版本还修复了一些构建问题。这些修复应不会影响与以前版本的兼容性。
您可以通过 &lt;a href=&quot;https://github.com/ruby/ruby/compare/v2_7_6...v2_7_7&quot;&gt;提交日志&lt;/a&gt; 获取更多信息。&lt;/p&gt;
&lt;h2&gt;下载&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&quot;https://cache.ruby-lang.org/pub/ruby/2.7/ruby-2.7.7.tar.bz2&quot;&gt;https://cache.ruby-lang.org/pub/ruby/2.7/ruby-2.7.7.tar.bz2&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;文件大小: 14850886
SHA1: dfcd86b459a9d4bbdf2d4eb82ad3476cb9820892
SHA256: cf800820c9e69cdd31a8cdab920391f74ed935db2397a905afabd48961913658
SHA512: 24cc772ac1b56d3bb423f1b33716f221bf534f3717a506bf8235a698f8a454db7d79d94ae9a84067153c2f737b3f8f6085f34e36cc04be0d75ae2fdd57718870
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&quot;https://cache.ruby-lang.org/pub/ruby/2.7/ruby-2.7.7.tar.gz&quot;&gt;https://cache.ruby-lang.org/pub/ruby/2.7/ruby-2.7.7.tar.gz&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;文件大小: 16947579
SHA1: a038ab04e9d6dff7f9e7187b65497b29d4400597
SHA256: e10127db691d7ff36402cfe88f418c8d025a3f1eea92044b162dd72f0b8c7b90
SHA512: 7e6259f0e7a5687d12fded914dcb93e283e956022be40ef8fc6a27f66be14e057d8101b05c7b042b43fc24e3b5c4092d1675917a814d74b08adb63a3388baed2
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&quot;https://cache.ruby-lang.org/pub/ruby/2.7/ruby-2.7.7.tar.xz&quot;&gt;https://cache.ruby-lang.org/pub/ruby/2.7/ruby-2.7.7.tar.xz&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;文件大小: 12101804
SHA1: 28e2b97728bf89f64a1b787821660d5412657057
SHA256: b38dff2e1f8ce6e5b7d433f8758752987a6b2adfd9bc7571dbc42ea5d04e3e4c
SHA512: a19be3f0dfce040fe79f439e606f179d6750d2cc6e7b64fd65933edd487f5995573f7d0730beec9d3edadf942f8e9216f01ab3fff189d6cbe9d46a9add3e2683
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&quot;https://cache.ruby-lang.org/pub/ruby/2.7/ruby-2.7.7.zip&quot;&gt;https://cache.ruby-lang.org/pub/ruby/2.7/ruby-2.7.7.zip&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;文件大小: 20730295
SHA1: bf41b294f428a4f8a38894f8fa613dd6f889c317
SHA256: 7b48a8411bb79a06e9edbbb7380bd82527697b7d8f62840b985111003317bae0
SHA512: 90dabc0fcedc25e3e46d5e9f2dff01c56e142c2e71b95c4c5f4da056f1e47cb320ef8b949282fd9594869e91cd76eab27ad70061be6c26b0d0d8837ae0fb8309
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;版本说明&lt;/h2&gt;
&lt;p&gt;许多提交者、开发人员以及用户提供了问题报告，帮助我们完成了此版本。
感谢他们的贡献。&lt;/p&gt;

&lt;p&gt;由 usa 发表于 2022-11-24&lt;br /&gt;翻译： GAO Jun&lt;/p&gt;</description>
      <pubDate>Thu, 24 Nov 2022 12:00:00 +0000</pubDate>
      <guid>https://www.ruby-lang.org/zh_cn/news/2022/11/24/ruby-2-7-7-released/</guid>
      <link>https://www.ruby-lang.org/zh_cn/news/2022/11/24/ruby-2-7-7-released/</link>
    </item>
    
    <item>
      <title>CVE-2021-33621: CGI 中的 HTTP 响应拆分漏洞</title>
      <description>&lt;p&gt;我们发布了 cgi gem 0.3.5， 0.2.2 和 0.1.0.2，对 HTTP 响应拆分漏洞进行了安全修复。
此漏洞已分配 CVE 编号 &lt;a href=&quot;https://nvd.nist.gov/vuln/detail/CVE-2021-33621&quot;&gt;CVE-2021-33621&lt;/a&gt;。&lt;/p&gt;
&lt;h2&gt;详情&lt;/h2&gt;
&lt;p&gt;如果应用程序使用 cgi gem 并基于不受信用户的输入生成 HTTP 响应，攻击者可以利用此漏洞来注入恶意的 HTTP 响应头与正文。&lt;/p&gt;
&lt;p&gt;此外，由于没有正确校验 &lt;code&gt;CGI::Cookie&lt;/code&gt; 对象的内容，如果应用程序基于用户输入创建 &lt;code&gt;CGI::Cookie&lt;/code&gt; 对象，攻击者可以利用此漏洞在 &lt;code&gt;Set-Cookie&lt;/code&gt; 头中注入无效属性。 我们认为这样的应用程序不太可能会有，但我们包含了一个更新来预防性地检查 &lt;code&gt;CGI::Cookie#initialize&lt;/code&gt; 的参数。&lt;/p&gt;
&lt;p&gt;请将 cgi gem 更新到 0.3.5， 0.2.2， 与 0.1.0.2 及对应后续版本。您可以通过 &lt;code&gt;gem update cgi&lt;/code&gt; 来进行更新。
如果您使用 bundler，请在您的 &lt;code&gt;Gemfile&lt;/code&gt; 中增加 &lt;code&gt;gem &amp;quot;cgi&amp;quot;, &amp;quot;&amp;gt;= 0.3.5&amp;quot;&lt;/code&gt;。&lt;/p&gt;
&lt;h2&gt;受影响版本&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;cgi gem 0.3.3 及更早版本&lt;/li&gt;
&lt;li&gt;cgi gem 0.2.1 及更早版本&lt;/li&gt;
&lt;li&gt;cgi gem 0.1.1，0.1.0.1，0.1.0&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;致谢&lt;/h2&gt;
&lt;p&gt;感谢 &lt;a href=&quot;https://hackerone.com/htokumaru?type=user&quot;&gt;Hiroshi Tokumaru&lt;/a&gt; 发现此问题。&lt;/p&gt;
&lt;h2&gt;历史&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;最早发布于 2022-11-22 02:00:00 (UTC)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;由 mame 发表于 2022-11-22&lt;br /&gt;翻译： GAO Jun&lt;/p&gt;</description>
      <pubDate>Tue, 22 Nov 2022 02:00:00 +0000</pubDate>
      <guid>https://www.ruby-lang.org/zh_cn/news/2022/11/22/http-response-splitting-in-cgi-cve-2021-33621/</guid>
      <link>https://www.ruby-lang.org/zh_cn/news/2022/11/22/http-response-splitting-in-cgi-cve-2021-33621/</link>
    </item>
    
    <item>
      <title>Ruby 3.2.0 Preview 3 已发布</title>
      <description>&lt;p&gt;我们很高兴地宣布 Ruby 3.2.0-preview3。Ruby 3.2 增加了很多新功能和性能改进。&lt;/p&gt;
&lt;h2&gt;基于 WASI 的 WebAssembly 支持&lt;/h2&gt;
&lt;p&gt;这是首次基于 WASI 的 WebAssembly 支持。使得 CRuby 二进制内容可用于浏览器、Serverless Edge、以及其他 WebAssembly/WASI 嵌入环境。目前，此功能已通过除 Thread API 之外的 basic 和 bootstrap 测试套件。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://i.imgur.com/opCgKy2.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
&lt;h3&gt;背景&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;https://webassembly.org/&quot;&gt;WebAssembly (Wasm)&lt;/a&gt; 希望能够在浏览器中提供安全快速的运行程序的方式。但其目标，也就是在不同环境中安全高效的运行程序，不仅是 web 应用长期以来的目标，也是其他一般程序所需要的。&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://wasi.dev/&quot;&gt;WASI (The WebAssembly System Interface)&lt;/a&gt; 被设计用于此类应用场景。尽管此类应用需要与操作系统进行通信，WebAssembly 却运行在一个没有系统接口的虚拟机之上。WASI 使之标准化。&lt;/p&gt;
&lt;p&gt;基于这些项目，Ruby 的 WebAssembly/WASI 支持能使 Ruby 开发者可以编写能运行于兼容此类功能的平台上。&lt;/p&gt;
&lt;h3&gt;应用场景&lt;/h3&gt;
&lt;p&gt;此功能使得开发人员可以在 WebAssembly 环境中使用 CRuby。一个此类应用场景的案例是 &lt;a href=&quot;https://try.ruby-lang.org/playground/&quot;&gt;TryRuby playground&lt;/a&gt; 的 CRuby 支持。现在您可以在您的浏览器中尝试原生的 CRuby。&lt;/p&gt;
&lt;h3&gt;技术要点&lt;/h3&gt;
&lt;p&gt;目前，WASI 和 WebAssembly 仍在不断演进，同时基于安全原因，还缺少一些功能来实现纤程、异常和垃圾回收。
所以，CRuby 使用了一种可以控制用户空间中执行的二进制转换技术 Asyncify 来填补这一鸿沟。&lt;/p&gt;
&lt;p&gt;此外，我们创建了 &lt;a href=&quot;https://github.com/kateinoigakukun/wasi-vfs/wiki/Getting-Started-with-CRuby&quot;&gt;WASI 之上的虚拟文件系统&lt;/a&gt;，于是就可以很容易地将 Ruby 应用打包成单个 .wasm 文件，进而简化分发 Ruby 应用的过程。&lt;/p&gt;
&lt;h3&gt;相关链接&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/ruby/ruby/pull/5407&quot;&gt;Add WASI based WebAssembly support #5407&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://itnext.io/final-report-webassembly-wasi-support-in-ruby-4aface7d90c9&quot;&gt;An Update on WebAssembly/WASI Support in Ruby&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Regexp 用于防御 ReDoS 攻击的改进&lt;/h2&gt;
&lt;p&gt;众所周知，正则表达式匹配的耗时可能出乎意料的长。如果您的代码尝试从一个不可信输入中匹配一个低效的正则表达式，攻击者可以借此发起有效的拒绝服务攻击(所谓的正则表达式 DoS，或 ReDoS)。&lt;/p&gt;
&lt;p&gt;我们引入了2个更新，能够显著减轻 ReDoS 的影响&lt;/p&gt;
&lt;h3&gt;改进 Regexp 匹配算法&lt;/h3&gt;
&lt;p&gt;自 Ruby 3.2 开始，Regexp 的匹配算法通过缓存技术得到了显著改进。
新增正则表达式匹配的超时设置。&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# 下面的正则匹配在 Ruby 3.1 中耗时10秒，在 Ruby 3.2 中耗时0.003秒

/^a*b?a*$/ =~ &quot;a&quot; * 50000 + &quot;x&quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;通过改进的匹配算法，使得 Regexp 的匹配（根据我们的实验，约90%）能够在线性时间内完成。&lt;/p&gt;
&lt;p&gt;（致 Preview 用户：此改进可能会消耗与每个匹配的输入长度成比例的内存。我们预计不会出现实际问题，因为这种内存分配通常会延迟，并且正常的 Regexp 匹配最多只会消耗表达式长度10倍的内存。如果您在实际应用中遇到 Regexp 匹配导致的内存不足情况，请报告给我们。）&lt;/p&gt;
&lt;p&gt;最初提议 &lt;a href=&quot;https://bugs.ruby-lang.org/issues/19104&quot;&gt;https://bugs.ruby-lang.org/issues/19104&lt;/a&gt;&lt;/p&gt;
&lt;h3&gt;Regexp 超时设置&lt;/h3&gt;
&lt;p&gt;上面的改进不能使用于某些正则表达式，比如使用了某些高级特性（例如：反向引用 back-references，环视 look-around），或者大量使用固定重复次数。作为一种后备措施，Regexp 还引入了超时设置功能。&lt;/p&gt;
&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;no&quot;&gt;Regexp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;timeout&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.0&lt;/span&gt;

&lt;span class=&quot;sr&quot;&gt;/^a*b?a*()\1$/&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=~&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;a&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;50000&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;x&quot;&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#=&amp;gt; 1秒后 Regexp::TimeoutError&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;请注意，&lt;code&gt;Regexp.timeout&lt;/code&gt; 是全局性的配置。如果您希望对于某些特殊的正则表达式使用不同的超时设置，您可以使用 &lt;code&gt;Regexp.new&lt;/code&gt; 中的 &lt;code&gt;timeout&lt;/code&gt; 关键词。&lt;/p&gt;
&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;no&quot;&gt;Regexp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;timeout&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.0&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# 这个 Regexp 没有超时设置&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;long_time_re&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Regexp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'^a*b?a*()\1$'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;timeout: &lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Float&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;INFINITY&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;long_time_re&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=~&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;a&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;50000&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;x&quot;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# 不会被中断&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;最初提议：&lt;a href=&quot;https://bugs.ruby-lang.org/issues/17837&quot;&gt;https://bugs.ruby-lang.org/issues/17837&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;其他值得注意的新功能&lt;/h2&gt;
&lt;h3&gt;不再捆绑第三方源代码&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;我们不再捆绑第三方源代码，例如 &lt;code&gt;libyaml&lt;/code&gt;， &lt;code&gt;libffi&lt;/code&gt;。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;psych 中已经移除了 libyaml 的代码。您可能需要在 Ubuntu/Debian 平台中安装 &lt;code&gt;libyaml-dev&lt;/code&gt;。软件包的名称可能因平台不同而各异。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;从 &lt;code&gt;fiddle&lt;/code&gt; 中移除捆绑的 libffi 源码&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;语言&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;除了在方法参数中使用，匿名的可变长参数现在可以作为参数进行传递
[&lt;a href=&quot;https://bugs.ruby-lang.org/issues/18351&quot;&gt;Feature #18351&lt;/a&gt;]&lt;/p&gt;
&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;foo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;bar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;baz&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;quux&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;接受一个单独位置参数的 proc 不再会自动解封装。 [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/18633&quot;&gt;Bug #18633&lt;/a&gt;]&lt;/p&gt;
&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;nb&quot;&gt;proc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;call&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Ruby 3.1 及之前版本&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# =&amp;gt; 1&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Ruby 3.2 及之后版本&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# =&amp;gt; [1, 2]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;对于显示对象的常量赋值求值顺序，将始终使用单属性赋值求值顺序。参考下面的代码:&lt;/p&gt;
&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;n&quot;&gt;foo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;BAR&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;baz&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;code&gt;foo&lt;/code&gt; 现在在 &lt;code&gt;baz&lt;/code&gt; 之前求值。类似的，对于多重常量的赋值，使用从左到右的求值顺序。参考下面的代码:&lt;/p&gt;
&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code data-lang=&quot;ruby&quot;&gt;  &lt;span class=&quot;n&quot;&gt;foo1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;BAR1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;foo2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;BAR2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;baz1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;baz2&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;现在使用下面的求值顺序:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code&gt;foo1&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;foo2&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;baz1&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;baz2&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;[&lt;a href=&quot;https://bugs.ruby-lang.org/issues/15928&quot;&gt;Bug #15928&lt;/a&gt;]&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;查找模式不再是实验性功能。
[&lt;a href=&quot;https://bugs.ruby-lang.org/issues/18585&quot;&gt;Feature #18585&lt;/a&gt;]&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;使用可变长参数 (例如 &lt;code&gt;*args&lt;/code&gt;) 的方法，如果同时希望通过 &lt;code&gt;foo(*args)&lt;/code&gt; 使用关键词参数的，那么必须使用 &lt;code&gt;ruby2_keywords&lt;/code&gt; 进行标记。也就是说，所有希望通过 &lt;code&gt;*args&lt;/code&gt; 来使用关键字参数的方法现在毫无例外地都必须使用
&lt;code&gt;ruby2_keywords&lt;/code&gt; 进行标记。一旦某个库需要 Ruby 3+，这将是一个更容易的过渡升级方式。此前，当接收方法使用 &lt;code&gt;*args&lt;/code&gt; 时，&lt;code&gt;ruby2_keywords&lt;/code&gt; 标记被保留，但这可能是错误并且是行为不一致的。对于查找潜在缺失的
&lt;code&gt;ruby2_keywords&lt;/code&gt; 的好方法应当是运行测试套件，检查测试失败时调用的最后一个方法，这个方法必须接收关键词参数。通过在错误处使用 &lt;code&gt;puts nil, caller, nil&lt;/code&gt;，然后检查在调用链上的每一个使用自动委派关键词的方法/块被标记为
&lt;code&gt;ruby2_keywords&lt;/code&gt;。 [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/18625&quot;&gt;Bug #18625&lt;/a&gt;] [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/16466&quot;&gt;Bug #16466&lt;/a&gt;]&lt;/p&gt;
&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;target&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;kw&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Ruby 2.7-3.1 可以意外地在没有 ruby2_keywords 的情况下执行，在 3.2 中必需。&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# 如需去除 ruby2_keywords，需要修改 #foo 和 #bar 的参数为 (*args, **kwargs) 或 (...)。&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ruby2_keywords&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;bar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;target&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;ruby2_keywords&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;foo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;bar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;foo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;k: &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;性能改进&lt;/h2&gt;
&lt;h3&gt;YJIT&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;在 UNIX 平台中支持 arm64 / aarch64。&lt;/li&gt;
&lt;li&gt;编译 YJIT 需要 Rust 1.58.1+. [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/18481&quot;&gt;Feature #18481&lt;/a&gt;]&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;自 3.1 以来其他值得注意的变更&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Hash&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;当 hash 为空时，Hash#shift 现在总是返回 nil，此前行为是返回默认值或调用默认 proc。 [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/16908&quot;&gt;Bug #16908&lt;/a&gt;]&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;MatchData&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;新增 MatchData#byteoffset 。 [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/13110&quot;&gt;Feature #13110&lt;/a&gt;]&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Module&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;新增 Module.used_refinements 。 [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/14332&quot;&gt;Feature #14332&lt;/a&gt;]&lt;/li&gt;
&lt;li&gt;新增 Module#refinements 。 [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/12737&quot;&gt;Feature #12737&lt;/a&gt;]&lt;/li&gt;
&lt;li&gt;新增 Module#const_added 。 [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/17881&quot;&gt;Feature #17881&lt;/a&gt;]&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Proc&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Proc#dup 返回子类的一个实例。 [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/17545&quot;&gt;Bug #17545&lt;/a&gt;]&lt;/li&gt;
&lt;li&gt;Proc#parameters 现在接受 lambda 关键字。 [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/15357&quot;&gt;Feature #15357&lt;/a&gt;]&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Refinement&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;新增 Refinement#refined_class。 [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/12737&quot;&gt;Feature #12737&lt;/a&gt;]&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;RubyVM::AbstractSyntaxTree&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;为&lt;code&gt;parse&lt;/code&gt;, &lt;code&gt;parse_file&lt;/code&gt; 和 &lt;code&gt;of&lt;/code&gt; 增加选项 &lt;code&gt;error_tolerant&lt;/code&gt;。 [[Feature #19013]]&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Set&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Set 现在可以直接使用，不需要调用 &lt;code&gt;require &amp;quot;set&amp;quot;&lt;/code&gt;。 [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/16989&quot;&gt;Feature #16989&lt;/a&gt;]
目前其通过 &lt;code&gt;Set&lt;/code&gt; 常量或对 &lt;code&gt;Enumerable#to_set&lt;/code&gt; 调用自动载入。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;String&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;新增 String#byteindex 和 String#byterindex 。 [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/13110&quot;&gt;Feature #13110&lt;/a&gt;]&lt;/li&gt;
&lt;li&gt;更新 Unicode 至 Version 14.0.0，Emoji Version 14.0. [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/18037&quot;&gt;Feature #18037&lt;/a&gt;] (同样适用于 Regexp)&lt;/li&gt;
&lt;li&gt;新增 String#bytesplice 。  [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/18598&quot;&gt;Feature #18598&lt;/a&gt;]&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Struct&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;即使在 &lt;code&gt;Struct.new&lt;/code&gt; 中不设置 &lt;code&gt;keyword_init: true&lt;/code&gt;，Struct 类也可以通过关键词参数进行初始化。 [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/16806&quot;&gt;Feature #16806&lt;/a&gt;]&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;兼容性问题&lt;/h2&gt;
&lt;p&gt;注意：不包含特性的问题修正&lt;/p&gt;
&lt;h3&gt;被移除的常量&lt;/h3&gt;
&lt;p&gt;下列废弃常量被移除。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;Fixnum&lt;/code&gt; 与 &lt;code&gt;Bignum&lt;/code&gt; [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/12005&quot;&gt;Feature #12005&lt;/a&gt;]&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Random::DEFAULT&lt;/code&gt; [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/17351&quot;&gt;Feature #17351&lt;/a&gt;]&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Struct::Group&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Struct::Passwd&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;被移除的方法&lt;/h3&gt;
&lt;p&gt;下列废弃方法被移除。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;Dir.exists?&lt;/code&gt; [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/17391&quot;&gt;Feature #17391&lt;/a&gt;]&lt;/li&gt;
&lt;li&gt;&lt;code&gt;File.exists?&lt;/code&gt; [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/17391&quot;&gt;Feature #17391&lt;/a&gt;]&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Kernel#=~&lt;/code&gt; [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/15231&quot;&gt;Feature #15231&lt;/a&gt;]&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Kernel#taint&lt;/code&gt;, &lt;code&gt;Kernel#untaint&lt;/code&gt;, &lt;code&gt;Kernel#tainted?&lt;/code&gt;
[&lt;a href=&quot;https://bugs.ruby-lang.org/issues/16131&quot;&gt;Feature #16131&lt;/a&gt;]&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Kernel#trust&lt;/code&gt;, &lt;code&gt;Kernel#untrust&lt;/code&gt;, &lt;code&gt;Kernel#untrusted?&lt;/code&gt;
[&lt;a href=&quot;https://bugs.ruby-lang.org/issues/16131&quot;&gt;Feature #16131&lt;/a&gt;]&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;标准库兼容性问题&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;Psych&lt;/code&gt; 不再捆绑 libyaml 源代码
用户需要自行通过包管理系统安装 libyaml 库。[&lt;a href=&quot;https://bugs.ruby-lang.org/issues/18571&quot;&gt;Feature #18571&lt;/a&gt;]&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;C API 更新&lt;/h2&gt;
&lt;h3&gt;更新的 C API&lt;/h3&gt;
&lt;p&gt;下列 API 被更新&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;PRNG 更新
&lt;code&gt;rb_random_interface_t&lt;/code&gt; 被更新并设定版本。
如果扩展库使用旧版本的接口需要更新。
同样，&lt;code&gt;init_int32&lt;/code&gt; 函数需要被定义。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;被移除的 C API&lt;/h3&gt;
&lt;p&gt;下列废弃的 API 被移除。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;变量 &lt;code&gt;rb_cData&lt;/code&gt;。&lt;/li&gt;
&lt;li&gt;&amp;quot;taintedness&amp;quot; 与 &amp;quot;trustedness&amp;quot; 函数。 [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/16131&quot;&gt;Feature #16131&lt;/a&gt;]&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;标准库更新&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;SyntaxSuggest&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;syntax_suggest&lt;/code&gt;（原名 &lt;code&gt;dead_end&lt;/code&gt;）被集成进 Ruby。[&lt;a href=&quot;https://bugs.ruby-lang.org/issues/18159&quot;&gt;Feature #18159&lt;/a&gt;]&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ErrorHighlight&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;对于 TypeError 和 ArgumentErrorNow，现在错误提示指向对应参数&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;test.rb:2:in `+': nil can't be coerced into Integer (TypeError)

sum = ary[0] + ary[1]
               ^^^^^^
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;下列默认 gems 被更新。
&lt;ul&gt;
&lt;li&gt;RubyGems 3.4.0.dev&lt;/li&gt;
&lt;li&gt;bigdecimal 3.1.2&lt;/li&gt;
&lt;li&gt;bundler 2.4.0.dev&lt;/li&gt;
&lt;li&gt;cgi 0.3.2&lt;/li&gt;
&lt;li&gt;date 3.2.3&lt;/li&gt;
&lt;li&gt;error_highlight 0.4.0&lt;/li&gt;
&lt;li&gt;etc 1.4.0&lt;/li&gt;
&lt;li&gt;io-console 0.5.11&lt;/li&gt;
&lt;li&gt;io-nonblock 0.1.1&lt;/li&gt;
&lt;li&gt;io-wait 0.3.0.pre&lt;/li&gt;
&lt;li&gt;ipaddr 1.2.4&lt;/li&gt;
&lt;li&gt;json 2.6.2&lt;/li&gt;
&lt;li&gt;logger 1.5.1&lt;/li&gt;
&lt;li&gt;net-http 0.2.2&lt;/li&gt;
&lt;li&gt;net-protocol 0.1.3&lt;/li&gt;
&lt;li&gt;ostruct 0.5.5&lt;/li&gt;
&lt;li&gt;psych 5.0.0.dev&lt;/li&gt;
&lt;li&gt;reline 0.3.1&lt;/li&gt;
&lt;li&gt;securerandom 0.2.0&lt;/li&gt;
&lt;li&gt;set 1.0.3&lt;/li&gt;
&lt;li&gt;stringio 3.0.3&lt;/li&gt;
&lt;li&gt;syntax_suggest 0.0.1&lt;/li&gt;
&lt;li&gt;timeout 0.3.0&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;下列绑定 gems 被更新。
&lt;ul&gt;
&lt;li&gt;minitest 5.16.3&lt;/li&gt;
&lt;li&gt;net-imap 0.2.3&lt;/li&gt;
&lt;li&gt;rbs 2.6.0&lt;/li&gt;
&lt;li&gt;typeprof 0.21.3&lt;/li&gt;
&lt;li&gt;debug 1.6.2&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;系列默认 gems 现在是绑定 gems。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;您可以通过 &lt;a href=&quot;https://github.com/ruby/ruby/blob/v3_2_0_preview3/NEWS.md&quot;&gt;新闻&lt;/a&gt;
或 &lt;a href=&quot;https://github.com/ruby/ruby/compare/v3_1_0...v3_2_0_preview3&quot;&gt;提交日志&lt;/a&gt;
获取更多信息。&lt;/p&gt;
&lt;p&gt;自 Ruby 3.1.0 以来，伴随这些变更， &lt;a href=&quot;https://github.com/ruby/ruby/compare/v3_1_0...v3_2_0_preview3#file_bucket&quot;&gt;2719 个文件被更改， 新增 191269 行(+)，删除 120315 行(-)&lt;/a&gt;!&lt;/p&gt;
&lt;h2&gt;下载&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&quot;https://cache.ruby-lang.org/pub/ruby/3.2/ruby-3.2.0-preview3.tar.gz&quot;&gt;https://cache.ruby-lang.org/pub/ruby/3.2/ruby-3.2.0-preview3.tar.gz&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;SIZE: 20086542
SHA1: dafca8116d36ceaa32482ab38359768de8c3ae5e
SHA256: c041d1488e62730d3a10dbe7cf7a3b3e4268dc867ec20ec991e7d16146640487
SHA512: 860634d95e4b9c48f18d38146dfbdc3c389666d45454248a4ccdfc3a5d3cd0c71c73533aabf359558117de9add1472af228d8eaec989c9336b1a3a6f03f1ae88
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&quot;https://cache.ruby-lang.org/pub/ruby/3.2/ruby-3.2.0-preview3.tar.xz&quot;&gt;https://cache.ruby-lang.org/pub/ruby/3.2/ruby-3.2.0-preview3.tar.xz&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;SIZE: 14799804
SHA1: c94e2add05502cb5c39afffc995b7c8f000f7df0
SHA256: d3f5619de544240d92a5d03aa289e71bd1103379622c523a0e80ed029a74b3bb
SHA512: c1864e2e07c3711eaa17d0f85dfbcc6e0682b077782bb1c155315af45139ae66dc4567c73682d326975b0f472111eb0a70f949811cb54bed0b3a816ed6ac34df
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&quot;https://cache.ruby-lang.org/pub/ruby/3.2/ruby-3.2.0-preview3.zip&quot;&gt;https://cache.ruby-lang.org/pub/ruby/3.2/ruby-3.2.0-preview3.zip&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;SIZE: 24426893
SHA1: 346c051c4be7ab8d0b551fd2ff8169785697db62
SHA256: cf49aa70e7ebd8abebffd5e49cd3bd92e5b9f3782d587cc7ed88c98dd5f17069
SHA512: 4f22b5ea91be17ef5f68cf0acb1e3a226dcc549ad71cc9b40e623220087c4065ca9bea942710f668e5c94ca0323da8d2ccd565f95a9085c1a0e38e9c0543b22f
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Ruby是什么&lt;/h2&gt;
&lt;p&gt;Ruby 最初由 Matz （松本行弘，Yukihiro Matsumoto） 于 1993 年开发，现在以开源软件的形式开发。它可以在多个平台上运行，并在全球得到广泛使用，尤其是Web开发领域。&lt;/p&gt;

&lt;p&gt;由 naruse 发表于 2022-11-11&lt;br /&gt;翻译： GAO Jun&lt;/p&gt;</description>
      <pubDate>Fri, 11 Nov 2022 00:00:00 +0000</pubDate>
      <guid>https://www.ruby-lang.org/zh_cn/news/2022/11/11/ruby-3-2-0-preview3-released/</guid>
      <link>https://www.ruby-lang.org/zh_cn/news/2022/11/11/ruby-3-2-0-preview3-released/</link>
    </item>
    
    <item>
      <title>Ruby 3.2.0 Preview 2 已发布</title>
      <description>&lt;p&gt;我们很高兴地宣布 Ruby 3.2.0-preview2。Ruby 3.2 增加了很多新功能和性能改进。&lt;/p&gt;
&lt;h2&gt;基于 WASI 的 WebAssembly 支持&lt;/h2&gt;
&lt;p&gt;这是首次基于 WASI 的 WebAssembly 支持。使得 CRuby 二进制内容可用于浏览器、Serverless Edge、以及其他 WebAssembly/WASI 嵌入环境。目前，此功能已通过除 Thread API 之外的 basic 和 bootstrap 测试套件。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://i.imgur.com/opCgKy2.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
&lt;h3&gt;背景&lt;/h3&gt;
&lt;p&gt;&lt;a href=&quot;https://webassembly.org/&quot;&gt;WebAssembly (Wasm)&lt;/a&gt; 希望能够在浏览器中提供安全快速的运行程序的方式。但其目标，也就是在不同环境中安全高效的运行程序，不仅是 web 应用长期以来的目标，也是其他一般程序所需要的。&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://wasi.dev/&quot;&gt;WASI (The WebAssembly System Interface)&lt;/a&gt; 被设计用于此类应用场景。尽管此类应用需要与操作系统进行通信，WebAssembly 却运行在一个没有系统接口的虚拟机之上。WASI 使之标准化。&lt;/p&gt;
&lt;p&gt;基于这些项目，Ruby 的 WebAssembly/WASI 支持能使 Ruby 开发者可以编写能运行于兼容此类功能的平台上。&lt;/p&gt;
&lt;h3&gt;应用场景&lt;/h3&gt;
&lt;p&gt;此功能使得开发人员可以在 WebAssembly 环境中使用 CRuby。一个此类应用场景的案例是 &lt;a href=&quot;https://try.ruby-lang.org/playground/&quot;&gt;TryRuby playground&lt;/a&gt; 的 CRuby 支持。现在您可以在您的浏览器中尝试原生的 CRuby。&lt;/p&gt;
&lt;h3&gt;技术要点&lt;/h3&gt;
&lt;p&gt;目前，WASI 和 WebAssembly 仍在不断演进，同时基于安全原因，还缺少一些功能来实现纤程、异常和垃圾回收。
所以，CRuby 使用了一种可以控制用户空间中执行的二进制转换技术 Asyncify 来填补这一鸿沟。&lt;/p&gt;
&lt;p&gt;此外，我们创建了 &lt;a href=&quot;https://github.com/kateinoigakukun/wasi-vfs/wiki/Getting-Started-with-CRuby&quot;&gt;WASI 之上的虚拟文件系统&lt;/a&gt;，于是就可以很容易地将 Ruby 应用打包成单个 .wasm 文件，进而简化分发 Ruby 应用的过程。&lt;/p&gt;
&lt;h3&gt;相关链接&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/ruby/ruby/pull/5407&quot;&gt;Add WASI based WebAssembly support #5407&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://itnext.io/final-report-webassembly-wasi-support-in-ruby-4aface7d90c9&quot;&gt;An Update on WebAssembly/WASI Support in Ruby&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Regexp 超时设置&lt;/h2&gt;
&lt;p&gt;新增正则表达式匹配的超时设置。&lt;/p&gt;
&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;no&quot;&gt;Regexp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;timeout&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.0&lt;/span&gt;

&lt;span class=&quot;sr&quot;&gt;/^a*b?a*$/&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=~&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;a&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;50000&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;x&quot;&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#=&amp;gt; 1秒后 Regexp::TimeoutError&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;众所周知，正则表达式匹配的耗时可能出乎意料的长。如果您的代码尝试从一个不可信输入中匹配一个低效的正则表达式，攻击者可以借此发起有效的拒绝服务攻击(所谓的正则表达式 DoS，或 ReDoS)。&lt;/p&gt;
&lt;p&gt;根据您的 Ruby 程序的需要，可以通过设置 &lt;code&gt;Regexp.timeout&lt;/code&gt; 来避免或减轻这种 DoS 风险。请在您的程序中进行尝试，我们欢迎您的反馈。&lt;/p&gt;
&lt;p&gt;请注意，&lt;code&gt;Regexp.timeout&lt;/code&gt; 是全局性的配置。如果您希望对于某些特殊的正则表达式使用不同的超时设置，您可以使用 &lt;code&gt;Regexp.new&lt;/code&gt; 中的 &lt;code&gt;timeout&lt;/code&gt; 关键词。&lt;/p&gt;
&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;no&quot;&gt;Regexp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;timeout&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.0&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# 这个 Regexp 没有超时设置&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;long_time_re&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Regexp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;^a*b?a*$&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;timeout: &lt;/span&gt;&lt;span class=&quot;kp&quot;&gt;nil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;long_time_re&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=~&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;a&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;50000&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;x&quot;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# 不会被中断&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;最初提议： https://bugs.ruby-lang.org/issues/17837&lt;/p&gt;
&lt;h2&gt;其他值得注意的新功能&lt;/h2&gt;
&lt;h3&gt;不再捆绑第三方源代码&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;我们不再捆绑第三方源代码，例如 &lt;code&gt;libyaml&lt;/code&gt;， &lt;code&gt;libffi&lt;/code&gt;。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;psych 中已经移除了 libyaml 的代码。您可能需要在 Ubuntu/Debian 平台中安装 &lt;code&gt;libyaml-dev&lt;/code&gt;。软件包的名称可能因平台不同而各异。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;在 preview2 中，&lt;code&gt;fiddle&lt;/code&gt; 将移除 libffi。&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;语言&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;除了在方法参数中使用，匿名的可变长参数现在可以作为参数进行传递
[&lt;a href=&quot;https://bugs.ruby-lang.org/issues/18351&quot;&gt;Feature #18351&lt;/a&gt;]&lt;/p&gt;
&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;foo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;bar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;baz&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;quux&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;接受一个单独位置参数的 proc 不再会自动解封装。 [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/18633&quot;&gt;Bug #18633&lt;/a&gt;]&lt;/p&gt;
&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;nb&quot;&gt;proc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;call&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Ruby 3.1 及之前版本&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# =&amp;gt; 1&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Ruby 3.2 及之后版本&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# =&amp;gt; [1, 2]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;对于显示对象的常量赋值求值顺序，将始终使用单属性赋值求值顺序。参考下面的代码:&lt;/p&gt;
&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;n&quot;&gt;foo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;BAR&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;baz&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;code&gt;foo&lt;/code&gt; 现在在 &lt;code&gt;baz&lt;/code&gt; 之前求值。类似的，对于多重常量的赋值，使用从左到右的求值顺序。参考下面的代码:&lt;/p&gt;
&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code data-lang=&quot;ruby&quot;&gt;  &lt;span class=&quot;n&quot;&gt;foo1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;BAR1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;foo2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;BAR2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;baz1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;baz2&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;现在使用下面的求值顺序:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code&gt;foo1&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;foo2&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;baz1&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;baz2&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;[&lt;a href=&quot;https://bugs.ruby-lang.org/issues/15928&quot;&gt;Bug #15928&lt;/a&gt;]&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;查找模式不再是实验性功能。
[&lt;a href=&quot;https://bugs.ruby-lang.org/issues/18585&quot;&gt;Feature #18585&lt;/a&gt;]&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;使用可变长参数 (例如 &lt;code&gt;*args&lt;/code&gt;) 的方法，如果同时希望通过 &lt;code&gt;foo(*args)&lt;/code&gt; 使用关键词参数的，那么必须使用 &lt;code&gt;ruby2_keywords&lt;/code&gt; 进行标记。也就是说，所有希望通过 &lt;code&gt;*args&lt;/code&gt; 来使用关键字参数的方法现在毫无例外地都必须使用
&lt;code&gt;ruby2_keywords&lt;/code&gt; 进行标记。一旦某个库需要 Ruby 3+，这将是一个更容易的过渡升级方式。此前，当接收方法使用 &lt;code&gt;*args&lt;/code&gt; 时，&lt;code&gt;ruby2_keywords&lt;/code&gt; 标记被保留，但这可能是错误并且是行为不一致的。对于查找潜在缺失的
&lt;code&gt;ruby2_keywords&lt;/code&gt; 的好方法应当是运行测试套件，检查测试失败时调用的最后一个方法，这个方法必须接收关键词参数。通过在错误处使用 &lt;code&gt;puts nil, caller, nil&lt;/code&gt;，然后检查在调用链上的每一个使用自动委派关键词的方法/块被标记为
&lt;code&gt;ruby2_keywords&lt;/code&gt;。 [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/18625&quot;&gt;Bug #18625&lt;/a&gt;] [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/16466&quot;&gt;Bug #16466&lt;/a&gt;]&lt;/p&gt;
&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;target&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;kw&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Ruby 2.7-3.1 可以意外地在没有 ruby2_keywords 的情况下执行，在 3.2 中必需。&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# 如需去除 ruby2_keywords，需要修改 #foo 和 #bar 的参数为 (*args, **kwargs) 或 (...)。&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ruby2_keywords&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;bar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;target&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;ruby2_keywords&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;foo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;bar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;foo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;k: &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;性能改进&lt;/h2&gt;
&lt;h3&gt;YJIT&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;在 UNIX 平台中支持 arm64 / aarch64。&lt;/li&gt;
&lt;li&gt;编译 YJIT 需要 Rust 1.58.1+. [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/18481&quot;&gt;Feature #18481&lt;/a&gt;]&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;自 3.1 以来其他值得注意的变更&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Hash&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;当 hash 为空时，Hash#shift 现在总是返回 nil，此前行为是返回默认值或调用默认 proc。 [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/16908&quot;&gt;Bug #16908&lt;/a&gt;]&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;MatchData&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;新增 MatchData#byteoffset 。 [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/13110&quot;&gt;Feature #13110&lt;/a&gt;]&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Module&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;新增 Module.used_refinements 。 [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/14332&quot;&gt;Feature #14332&lt;/a&gt;]&lt;/li&gt;
&lt;li&gt;新增 Module#refinements 。 [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/12737&quot;&gt;Feature #12737&lt;/a&gt;]&lt;/li&gt;
&lt;li&gt;新增 Module#const_added 。 [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/17881&quot;&gt;Feature #17881&lt;/a&gt;]&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Proc&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Proc#dup 返回子类的一个实例。 [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/17545&quot;&gt;Bug #17545&lt;/a&gt;]&lt;/li&gt;
&lt;li&gt;Proc#parameters 现在接受 lambda 关键字。 [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/15357&quot;&gt;Feature #15357&lt;/a&gt;]&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Refinement&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;新增 Refinement#refined_class 。 [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/12737&quot;&gt;Feature #12737&lt;/a&gt;]&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Set&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Set 现在可以直接使用，不需要调用 &lt;code&gt;require &amp;quot;set&amp;quot;&lt;/code&gt;。 [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/16989&quot;&gt;Feature #16989&lt;/a&gt;]
目前其通过 &lt;code&gt;Set&lt;/code&gt; 常量或对 &lt;code&gt;Enumerable#to_set&lt;/code&gt; 调用自动载入。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;String&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;新增 String#byteindex 和 String#byterindex 。 [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/13110&quot;&gt;Feature #13110&lt;/a&gt;]&lt;/li&gt;
&lt;li&gt;更新 Unicode 至 Version 14.0.0，Emoji Version 14.0. [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/18037&quot;&gt;Feature #18037&lt;/a&gt;] (同样适用于 Regexp)&lt;/li&gt;
&lt;li&gt;新增 String#bytesplice 。  [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/18598&quot;&gt;Feature #18598&lt;/a&gt;]&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Struct&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;即使在 &lt;code&gt;Struct.new&lt;/code&gt; 中不设置 &lt;code&gt;keyword_init: true&lt;/code&gt;，Struct 类也可以通过关键词参数进行初始化。 [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/16806&quot;&gt;Feature #16806&lt;/a&gt;]&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;兼容性问题&lt;/h2&gt;
&lt;p&gt;注意：不包含特性的问题修正&lt;/p&gt;
&lt;h3&gt;被移除的常量&lt;/h3&gt;
&lt;p&gt;下列废弃常量被移除。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;Fixnum&lt;/code&gt; 与 &lt;code&gt;Bignum&lt;/code&gt; [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/12005&quot;&gt;Feature #12005&lt;/a&gt;]&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Random::DEFAULT&lt;/code&gt; [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/17351&quot;&gt;Feature #17351&lt;/a&gt;]&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Struct::Group&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Struct::Passwd&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;被移除的方法&lt;/h3&gt;
&lt;p&gt;下列废弃方法被移除。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;Dir.exists?&lt;/code&gt; [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/17391&quot;&gt;Feature #17391&lt;/a&gt;]&lt;/li&gt;
&lt;li&gt;&lt;code&gt;File.exists?&lt;/code&gt; [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/17391&quot;&gt;Feature #17391&lt;/a&gt;]&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Kernel#=~&lt;/code&gt; [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/15231&quot;&gt;Feature #15231&lt;/a&gt;]&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Kernel#taint&lt;/code&gt;, &lt;code&gt;Kernel#untaint&lt;/code&gt;, &lt;code&gt;Kernel#tainted?&lt;/code&gt;
[&lt;a href=&quot;https://bugs.ruby-lang.org/issues/16131&quot;&gt;Feature #16131&lt;/a&gt;]&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Kernel#trust&lt;/code&gt;, &lt;code&gt;Kernel#untrust&lt;/code&gt;, &lt;code&gt;Kernel#untrusted?&lt;/code&gt;
[&lt;a href=&quot;https://bugs.ruby-lang.org/issues/16131&quot;&gt;Feature #16131&lt;/a&gt;]&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;标准库兼容性问题&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;Psych&lt;/code&gt; 不再捆绑 libyaml 源代码
用户需要自行通过包管理系统安装 libyaml 库。[&lt;a href=&quot;https://bugs.ruby-lang.org/issues/18571&quot;&gt;Feature #18571&lt;/a&gt;]&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;C API 更新&lt;/h2&gt;
&lt;h3&gt;被移除的 C API&lt;/h3&gt;
&lt;p&gt;下列废弃的 API 被移除。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;变量 &lt;code&gt;rb_cData&lt;/code&gt;。&lt;/li&gt;
&lt;li&gt;&amp;quot;taintedness&amp;quot; 与 &amp;quot;trustedness&amp;quot; 函数。 [&lt;a href=&quot;https://bugs.ruby-lang.org/issues/16131&quot;&gt;Feature #16131&lt;/a&gt;]&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;标准库更新&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;下列默认 gems 被更新。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;待定&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;下列 bundled gems 被更新。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;待定&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;下列默认 gems 现在是 bundled gems。您需要在 bundler 环境中，将其加入 &lt;code&gt;Gemfile&lt;/code&gt; 文件。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;待定&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;您可以通过 &lt;a href=&quot;https://github.com/ruby/ruby/blob/v3_2_0_preview2/NEWS.md&quot;&gt;新闻&lt;/a&gt;
或 &lt;a href=&quot;https://github.com/ruby/ruby/compare/v3_1_0...v3_2_0_preview2&quot;&gt;提交日志&lt;/a&gt;
获取更多信息。&lt;/p&gt;
&lt;p&gt;自 Ruby 3.1.0 以来，伴随这些变更， &lt;a href=&quot;https://github.com/ruby/ruby/compare/v3_1_0...v3_2_0_preview2#file_bucket&quot;&gt;2393 个文件被更改， 新增 168931 行(+)，删除 113411 行(-)&lt;/a&gt;!&lt;/p&gt;
&lt;h2&gt;下载&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&quot;https://cache.ruby-lang.org/pub/ruby/3.2/ruby-3.2.0-preview2.tar.gz&quot;&gt;https://cache.ruby-lang.org/pub/ruby/3.2/ruby-3.2.0-preview2.tar.gz&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;SIZE: 19816780
SHA1: 2106c77fc1600daf41ae137ecc4cf7937e27f67f
SHA256: 8a78fd7a221b86032f96f25c1d852954c94d193b9d21388a9b434e160b7ed891
SHA512: 5e9ddcb1a43cff449b0062cc716bfb80a9ebbb14a1b063f34005e2998c2c5033badb44e882232db9b2fceda9376f6615986e983511fda2575d60894752b605cc
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&quot;https://cache.ruby-lang.org/pub/ruby/3.2/ruby-3.2.0-preview2.tar.xz&quot;&gt;https://cache.ruby-lang.org/pub/ruby/3.2/ruby-3.2.0-preview2.tar.xz&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;SIZE: 14578112
SHA1: 538b3ea4dc0d99f60f8bd6f71e65a56ceeb41c18
SHA256: 01fac0929dccdabc0686c1109da6c187897a401da9ff8851242befa92f7fd430
SHA512: 0f4cc919284fdfa1a42b6381760d1b3a4660da4b0fcdd2adf01ea04a425548b3c5ac090866915675db73964a1055090e54dd97cf4628cbb69403e541c71c28ff
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&quot;https://cache.ruby-lang.org/pub/ruby/3.2/ruby-3.2.0-preview2.zip&quot;&gt;https://cache.ruby-lang.org/pub/ruby/3.2/ruby-3.2.0-preview2.zip&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;SIZE: 24150109
SHA1: 69ffffc52cad626166f73f21f25c29c9d73fe0e8
SHA256: 67f9ad3110be1975b3ce547c0a6e2c910dfc1945fd6e9bb1bd340568897c6554
SHA512: 1447e099e7a8da0ff206fda6f4e466640d6e86e9da8148315ab0154684b1fd22c02c0022b5a2f4d3fc00103b4e8cef8e35a770174921fd8c6abeca9ad41c1818
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Ruby是什么&lt;/h2&gt;
&lt;p&gt;Ruby 最初由 Matz （松本行弘，Yukihiro Matsumoto） 于 1993 年开发，现在以开源软件的形式开发。它可以在多个平台上运行，并在全球得到广泛使用，尤其是Web开发领域。&lt;/p&gt;

&lt;p&gt;由 naruse 发表于 2022-09-09&lt;br /&gt;翻译： GAO Jun&lt;/p&gt;</description>
      <pubDate>Fri, 09 Sep 2022 00:00:00 +0000</pubDate>
      <guid>https://www.ruby-lang.org/zh_cn/news/2022/09/09/ruby-3-2-0-preview2-released/</guid>
      <link>https://www.ruby-lang.org/zh_cn/news/2022/09/09/ruby-3-2-0-preview2-released/</link>
    </item>
    
    <item>
      <title>Ruby 3.1.2 已发布</title>
      <description>&lt;p&gt;Ruby 3.1.2 已发布。&lt;/p&gt;
&lt;p&gt;此版本包括安全补丁。
请通过以下条目来获取详情。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;/zh_cn/news/2022/04/12/double-free-in-regexp-compilation-cve-2022-28738/&quot;&gt;CVE-2022-28738: Regexp 编译中的双重释放（double free）&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;/zh_cn/news/2022/04/12/buffer-overrun-in-string-to-float-cve-2022-28739/&quot;&gt;CVE-2022-28739: String 到 Float 转换中的缓冲区溢出&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;您可以通过 &lt;a href=&quot;https://github.com/ruby/ruby/compare/v3_1_1...v3_1_2&quot;&gt;提交日志&lt;/a&gt; 获取更多信息。&lt;/p&gt;
&lt;h2&gt;下载&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&quot;https://cache.ruby-lang.org/pub/ruby/3.1/ruby-3.1.2.tar.gz&quot;&gt;https://cache.ruby-lang.org/pub/ruby/3.1/ruby-3.1.2.tar.gz&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;文件大小: 20553628
SHA1: b0d86c60457fdfbcb532cb681877a2f790f66b25
SHA256: 61843112389f02b735428b53bb64cf988ad9fb81858b8248e22e57336f24a83e
SHA512: 9155d1150398eaea7c9954af61ecf8dfdb885cfcf63a67bbcf6c92e282cd3ccac0ff9234d039286a9623297b65197441438c37f707e31d270ce2fe11e8f38a44
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&quot;https://cache.ruby-lang.org/pub/ruby/3.1/ruby-3.1.2.tar.xz&quot;&gt;https://cache.ruby-lang.org/pub/ruby/3.1/ruby-3.1.2.tar.xz&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;文件大小: 15101588
SHA1: 4c47f1dfeeb23fc55d65bcae50cf70c23bc28aa3
SHA256: ca10d017f8a1b6d247556622c841fc56b90c03b1803f87198da1e4fd3ec3bf2a
SHA512: 4a74e9efc6ea4b3eff4fec7534eb1fff4794d021531defc2e9937e53c6668db8ecdc0fff2bc23d5e6602d0df344a2caa85b31c5414309541e3d5313ec82b6e21
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&quot;https://cache.ruby-lang.org/pub/ruby/3.1/ruby-3.1.2.zip&quot;&gt;https://cache.ruby-lang.org/pub/ruby/3.1/ruby-3.1.2.zip&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;文件大小: 24837444
SHA1: 2e04f25dc73d7236fd4f4a170329793cd5e7dc38
SHA256: f2bb80de50bcc17c29c1995d87d657d461ede6a73e71db44c0cf77f65f32e9b6
SHA512: fa3ba25a051bd1e0ea1ee9fadfeef674f2f3217b1468ccb24975c4a19493115cdeb0015a78d391d08870947de95a8c7409f1c00fed51dc49d40cc3e6cda25bb7
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;版本说明&lt;/h2&gt;
&lt;p&gt;许多提交者、开发人员以及用户提供了问题报告，帮助我们完成了此版本。
感谢他们的贡献。&lt;/p&gt;

&lt;p&gt;由 naruse and mame 发表于 2022-04-12&lt;br /&gt;翻译： GAO Jun&lt;/p&gt;</description>
      <pubDate>Tue, 12 Apr 2022 12:00:00 +0000</pubDate>
      <guid>https://www.ruby-lang.org/zh_cn/news/2022/04/12/ruby-3-1-2-released/</guid>
      <link>https://www.ruby-lang.org/zh_cn/news/2022/04/12/ruby-3-1-2-released/</link>
    </item>
    
    <item>
      <title>Ruby 3.0.4 已发布</title>
      <description>&lt;p&gt;Ruby 3.0.4 已发布。&lt;/p&gt;
&lt;p&gt;此版本包括安全补丁。
请通过以下条目来获取详情。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;/zh_cn/news/2022/04/12/double-free-in-regexp-compilation-cve-2022-28738/&quot;&gt;CVE-2022-28738: Regexp 编译中的双重释放（double free）&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;/zh_cn/news/2022/04/12/buffer-overrun-in-string-to-float-cve-2022-28739/&quot;&gt;CVE-2022-28739: String 到 Float 转换中的缓冲区溢出&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;您可以通过 &lt;a href=&quot;https://github.com/ruby/ruby/compare/v3_0_3...v3_0_4&quot;&gt;commit logs&lt;/a&gt; 获取更多信息。&lt;/p&gt;
&lt;h2&gt;下载&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&quot;https://cache.ruby-lang.org/pub/ruby/3.0/ruby-3.0.4.tar.gz&quot;&gt;https://cache.ruby-lang.org/pub/ruby/3.0/ruby-3.0.4.tar.gz&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;文件大小: 21139486
SHA1: 9c995a7a5cc3300ea1adb734017545e19d0af3ca
SHA256: 70b47c207af04bce9acea262308fb42893d3e244f39a4abc586920a1c723722b
SHA512: 0dfded6826063c1b39bf625a6e13b46c109cb160c8648b78f0965f70e7c7a1a65f1c117fc8f2cf8bdb34d7cbf79fecf1f45d169d2323406d66ab27b18bde1d22
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&quot;https://cache.ruby-lang.org/pub/ruby/3.0/ruby-3.0.4.tar.xz&quot;&gt;https://cache.ruby-lang.org/pub/ruby/3.0/ruby-3.0.4.tar.xz&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;文件大小: 15830368
SHA1: 14461adca874d42a06a11851029dec877d9d28de
SHA256: 8e22fc7304520435522253210ed0aa9a50545f8f13c959fe01a05aea06bef2f0
SHA512: 53bf7dd403b0c68af9691882ad8ed7422c8d1f496627428fb4c3caf0b0313715524b744c5f453aced2d49e16e55f3f45b46b9a77aa3097dbfcae7caa0208194b
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&quot;https://cache.ruby-lang.org/pub/ruby/3.0/ruby-3.0.4.zip&quot;&gt;https://cache.ruby-lang.org/pub/ruby/3.0/ruby-3.0.4.zip&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;文件大小: 25517085
SHA1: 6700ef07e3f7c4582d1b8004bfcce6cb4075b951
SHA256: d4ce9fd565a81ce138ea26382c8880f0456883b2539e18510e1d845293a095cb
SHA512: 2d97099161bcd17c5fdf1c70da6e062ae410186e7c1235e3b1df5bad6085e370bed3cf1ebd89ed9b5918cd386ae47d1f986a3c96c32f0c8a0b9375e56b66a1d9
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;版本说明&lt;/h2&gt;
&lt;p&gt;许多提交者、开发人员以及用户提供了问题报告，帮助我们完成了此版本。
感谢他们的贡献。&lt;/p&gt;

&lt;p&gt;由 nagachika and mame 发表于 2022-04-12&lt;br /&gt;翻译： GAO Jun&lt;/p&gt;</description>
      <pubDate>Tue, 12 Apr 2022 12:00:00 +0000</pubDate>
      <guid>https://www.ruby-lang.org/zh_cn/news/2022/04/12/ruby-3-0-4-released/</guid>
      <link>https://www.ruby-lang.org/zh_cn/news/2022/04/12/ruby-3-0-4-released/</link>
    </item>
    
  </channel>
</rss>
