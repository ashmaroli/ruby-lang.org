<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">

    
    <title>从 C/C++ 到 Ruby</title>
    

    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta itemprop="image" content="https://www.ruby-lang.org/images/header-ruby-logo@2x.png">
    
    <meta name="description" content="">
    

    <link rel="stylesheet" type="text/css" href="/stylesheets/normalize.css">
    <link rel="stylesheet" type="text/css" href="/stylesheets/main.css">
    <link rel="stylesheet" type="text/css" href="/stylesheets/pygments.css">
    <link rel="stylesheet" type="text/css" href="/stylesheets/mobile.css">
    <link rel="stylesheet" type="text/css" href="/stylesheets/print.css">
    <link href='https://fonts.googleapis.com/css?family=Noto+Sans:400,700,400italic,700italic&amp;subset=latin,cyrillic,greek,vietnamese' rel='stylesheet' type='text/css'>
    <link rel="canonical" href="https://www.ruby-lang.org/zh_cn/documentation/ruby-from-other-languages/to-ruby-from-c-and-cpp/">

    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico">
    
    <link href="/zh_cn/feeds/news.rss" rel="alternate" title="最新消息（RSS）" type="application/rss+xml">


    <script type="text/javascript" src="/javascripts/jquery.min.js"></script>
    <script type="text/javascript" src="/javascripts/page.js"></script>
    
  </head>

  

  <body>
    <div id="header">
      <div id="header_content" class="container">
        <a href="/zh_cn/">
          <h1>Ruby</h1>
          <h2>程序员最好的朋友</h2>
        </a>

        <div class="site-links">
          

  <a href="/zh_cn/" class="home">首页</a>

  <a href="/zh_cn/downloads/">下载</a>

  <a href="/zh_cn/documentation/">文档</a>

  <a href="/zh_cn/libraries/">代码库</a>

  <a href="/zh_cn/community/">社区</a>

  <a href="/zh_cn/news/">新闻</a>

  <a href="/zh_cn/security/">安全</a>

  <a href="/zh_cn/about/">关于 Ruby</a>


          <a href="#" class="menu selected">Menu</a>
        </div>

        <div id="search-box">
          
<form id="search-form" action="https://www.google.com/cse">
  <table class="fieldset">
    <tr>
      <td>
        <input class="field" type="text" name="q" size="31" style="background: white url(//www.google.com/coop/intl/zh_cn/images/google_custom_search_watermark.gif) left no-repeat" onfocus="this.style.background='white'" onblur="if (/^\s*$/.test(this.value)) this.style.background='white url(//www.google.com/coop/intl/zh_cn/images/google_custom_search_watermark.gif) left no-repeat'"/>
      </td>
      <td>
        
        <input type="hidden" name="ie" value="UTF-8" />
        <input class="button" type="submit" name="sa" value="搜索" />
      </td>
    </tr>
  </table>
</form>

        </div>
      </div>
    </div>

    <div id="page">
      


      <div id="main-wrapper" class="container">
        <div id="main">
          <div id="content-wrapper">
  
<h1>从 C/C++ 到 Ruby</h1>



  <div id="content">
    <p>很难用一个列表来描述 Ruby 与 C 或 C++ 代码的不同之处，因为差异相当大。其中一个原因是 Ruby 的运行时帮你做了很多工作。与 C 的“不隐藏内部机制”原则不同——Ruby 的关注点在于将繁重的工作交由运行时，使用者站在运行时的肩上，活的更轻松。除非或直到做代码优化，使用 Ruby 不用费心“让编译器高兴” 。</p>
<p>换句话说，Ruby 代码执行速度远远慢于“等价”的 C 或 C++ 代码是确定无疑的。相同的时间内，你头脑里关注的是如何快速的将一个 Ruby 程序运行起来，而且只需要很少的代码就可以做到。和把你搅成一锅粥的 C++ 相比，Ruby 要简单的多。</p>
<p>Ruby 是动态类型语言，而不是静态类型。它在运行的时候运行时做尽可能多的事。例如，你不用关心 Ruby 程序“链接”（也就是载入和使用）到哪里或之前调用什么方法。</p>
<p>可喜的是,事实证明 Ruby 和 C 之间的共生关系很和谐。Ruby 支持所谓“扩展模块”。这些模块由 C 语言编写，可以被 Ruby 程序调用（从外部来说，与其他 Ruby 模块表现和行为毫无二致）。通过这种方式,可以将性能关键部分从 Ruby 软件中切分出来,再由 C 语言打造。</p>
<p>当然，Ruby 本身是由 C 语言写的。</p>
<h3>与 C 相似点</h3>
<p>Ruby 与 C 一样的地方……</p>
<ul>
<li>如果喜欢，你可以面向过程编程（但是实际上仍然是面向对象）。</li>
<li>大多数的操作符是一样的（包括赋值操作和位操作）。但 Ruby 没有 <code>++</code> 或 <code>--</code> 。</li>
<li>有 <code>__FILE__</code> 和 <code>__LINE__</code>。</li>
<li>虽然没有 <code>const</code> 关键字，但常量还是有的。常量由命名约定约束——以大写字母开头的是常量。</li>
<li>字符串使用双引号。</li>
<li>字符串是可变类型。</li>
<li>与 man pages 类似，在终端窗口内使用 <code>ri</code> 命令可以浏览大部分文档。</li>
<li>可以使用同样的命令行调试器。</li>
</ul>
<h3>与 C++ 相似点</h3>
<p>Ruby 与 C++ 一样的地方……</p>
<ul>
<li>几乎一样的操作符（甚至 <code>::</code>）。<code>&lt;&lt;</code> 常用于向列表内追加元素。值得注意的是：Ruby 使用 <code>.</code>，而不使用 <code>-&gt;</code>。</li>
<li><code>public</code>、 <code>private</code> 和 <code>protected</code> 功能类似。</li>
<li>继承语法仍然只用一个字符，由 <code>&lt;</code> 变成 <code>:</code>。</li>
<li>你可以将代码放进“模块”内，与 C++ 中使用 <code>namespace</code> 类似。</li>
<li>为避免殃及池鱼，修改了异常（Exceptions）关键字， 但它们的工作类似。</li>
</ul>
<h3>与 C 相异点</h3>
<p>Ruby 与 C 不同的地方……</p>
<ul>
<li>对象是强类型（变量名本身完全没有类型）。</li>
<li>没有宏或预处理。没有类型转换。没有指针（也没有指针运算）。没有typedef，sizeof， enums。</li>
<li>没有头文件。只需要在源码文件中定义你的函数（通常称作“方法”）和类即可。</li>
<li>没有 <code>#define</code> 。使用常量代替。</li>
<li>就 Ruby 1.8 而言，代码在运行时解释，而不是编译成任何机器码或二进制码。</li>
<li>所有的变量存在于堆（heap）内。因此，不需要手动释放，垃圾回收器会帮你处理。</li>
<li>参数通过引用传递给方法（如：函数），不是通过值传递。</li>
<li>使用 <code>require 'foo'</code>，而不是 <code>#include &lt;foo&gt;</code> 或 <code>#include &quot;foo&quot;</code> 。</li>
<li>不能在程序中插入组合语言。</li>
<li>行末尾没有分号。</li>
<li><code>if</code> 和 <code>while</code> 条件表达式不需要括号。</li>
<li>方法调用的括号（如：函数）通常可选。</li>
<li>通常不使用括号，使用 <code>end</code> 关键字结束多行结构。</li>
<li><code>do</code> 关键字用于所谓的“代码块”。没有像 C 语言那样的“do statement”。</li>
<li>“代码块”意义不同。意思是当方法执行时方法体内调用的一系列代码。</li>
<li>没有变量声明。需要时再赋予一个新的名字即可。</li>
<li>判断真值时，只有 <code>false</code> 和 <code>nil</code> 当做假值。其余一切皆为真（包括 <code>0</code>、 <code>0.0</code>、 <code>&quot;&quot;</code> 和 <code>[]</code>）。</li>
<li>没有 <code>char</code> 类型，有的是只包含一个字符的字符串。</li>
<li>字符串不是以空字节结束。</li>
<li>数组字面量使用括号而不是花括号。</li>
<li>数组中加入更多元素时，数组会自动变大。</li>
<li>数组相加，返回的是一个新的更大的数组（当然，分配在堆（heap）上）而不是进行指针运算。</li>
<li>基本上，一切皆表达式（也就是说，像 <code>while</code> 声明也会有右值）。</li>
</ul>
<h3>与 C++ 相异点</h3>
<p>Ruby 与 C++ 不同的地方……</p>
<ul>
<li>没有明确引用。也就是在 Ruby 中，一切变量只是对象的一个自动非关联名称。</li>
<li>对象是强类型也是<em>动态</em>类型。 运行时在<em>运行的时候</em>才知道方法调用是否可用。</li>
<li>“构造器”是 <code>initialize</code> 而不是类名。</li>
<li>一切方法都是虚的。</li>
<li>“类”（静态）变量名总是以 <code>@@</code> 开头（像 <code>@@total_widgets</code> 这样）。</li>
<li>你不是直接访问成员变量，所有公开的成员变量（ Ruby 中称为属性）都通过方法访问。</li>
<li>使用 <code>self</code> 代替 <code>this</code>。</li>
<li>有一些以 <code>?</code> 或 <code>!</code> 结尾的方法。这些符号实际是方法名的一部分。</li>
<li>没有多重继承。然而 Ruby 有 “混入（mixins）”（比如，你可以“继承”某个模块的所有方法）。</li>
<li>有一些强制命名约定（例如：类名以大写字母开头，变量以小写字母开头）。</li>
<li>方法调用的括号是可选的。</li>
<li>随时重新打开类并增加方法。</li>
<li>不需要 C++ 模板（因为类型在运行时确定，所以可以给变量分配任意类型的对象），也没有类型转换。</li>
<li>迭代有一点点区别。Ruby 中，不使用单独的迭代对象（像 <code>vector&lt;T&gt;::const_iterator iter</code>），当你的对象混入 <code>Enumerator</code> 模块，你就可以像 <code>my_obj.each</code> 这样调用方法。</li>
<li>只有两种容器类型： 数组 <code>Array</code> 和哈希 <code>Hash</code>。</li>
<li>无类型转换。 你会发现在 Ruby 中，这没有必要。</li>
<li>内置多线程，就 Ruby 1.8 而言是“绿色线程”（只在解释器中实现）而非原生线程。</li>
<li>Ruby 标准库包含了单元测试库。</li>
</ul>

  </div>
</div>
<hr class="hidden-modern" />

<div id="sidebar-wrapper">
  <div id="sidebar">
    




<div class="navigation">
  <h3><strong>试用</strong>，其实很简单！</h3>

  <ul class="menu">
    <li><a href="https://try.ruby-lang.org/">在浏览器中试用 Ruby（英文）</a></li>

    
    <li><a href="/zh_cn/documentation/quickstart/">20 分钟体验 Ruby</a></li>
    

    
    <li><a href="/zh_cn/documentation/ruby-from-other-languages/">从其它语言转到 Ruby</a></li>
    
  </ul>
</div>



<div class="navigation">
  <h3><strong>探索</strong>新的世界</h3>
  <ul class="menu">
    
    <li><a href="/zh_cn/documentation/">文档</a></li>
    

    

    
    <li><a href="https://rubybib.org/">学术研究</a></li>
    

    
    <li><a href="/zh_cn/libraries/">代码库</a></li>
    

    
    <li><a href="/zh_cn/documentation/success-stories/">成功案例</a></li>
    
  </ul>
</div>



<div class="navigation">
  <h3><strong>加入</strong>友善及日益壮大的社区</h3>
  <ul>
    
    <li><a href="/zh_cn/community/mailing-lists/">邮件列表</a>: 联系喜爱 Ruby 的朋友</li>
    

    
    <li><a href="/zh_cn/community/user-groups/">用户组</a>: 参与 Ruby 爱好者活动</li>
    

    
    <li><a href="/zh_cn/community/weblogs/">博客</a>: 阅读 Ruby 相关的博客</li>
    

    
    <li><a href="/zh_cn/community/ruby-core/">Ruby 核心</a>: 帮助开发 Ruby 语言</li>
    

    
    <li><a href="https://bugs.ruby-lang.org/">问题跟踪</a>: 报告或帮助解决 Ruby 的问题</li>
    
  </ul>
</div>






    <h3>订阅</h3>
    <p><a href="/zh_cn/feeds/news.rss">最新消息（RSS）</a></p>


  </div>
</div>
<hr class="hidden-modern" />

        </div>
      </div>
    </div>

    <div class="container">
      <div id="footer">
        <div class="site-links">
          

  <a href="/zh_cn/" class="home">首页</a>

  <a href="/zh_cn/downloads/">下载</a>

  <a href="/zh_cn/documentation/">文档</a>

  <a href="/zh_cn/libraries/">代码库</a>

  <a href="/zh_cn/community/">社区</a>

  <a href="/zh_cn/news/">新闻</a>

  <a href="/zh_cn/security/">安全</a>

  <a href="/zh_cn/about/">关于 Ruby</a>


        </div>

        <p>

  本站其他语言版本：

<a href="/bg/">Български</a>,
<a href="/de/">Deutsch</a>,
<a href="/en/">English</a>,
<a href="/es/">Español</a>,
<a href="/fr/">Français</a>,
<a href="/id/">Bahasa Indonesia</a>,
<a href="/it/">Italiano</a>,
<a href="/ja/">日本語</a>,
<a href="/ko/">한국어</a>,
<a href="/pl/">polski</a>,
<a href="/pt/">Português</a>,
<a href="/ru/">Русский</a>,
<a href="/tr/">Türkçe</a>,
<a href="/vi/">Tiếng Việt</a>,
<a href="/zh_cn/">简体中文</a>,
<a href="/zh_tw/">繁體中文</a>.
</p>

        
  <p><a href="/zh_cn/about/website/">本站</a>由 Ruby 社区的成员共同维护。</p>


      </div>
    </div>
  </body>
</html>
